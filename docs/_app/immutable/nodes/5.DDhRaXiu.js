var ft=Object.defineProperty;var ht=(p,a,e)=>a in p?ft(p,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):p[a]=e;var A=(p,a,e)=>ht(p,typeof a!="symbol"?a+"":a,e);import{c as xe,a as h,t as I}from"../chunks/e-TftYpV.js";import{at as _t,aG as gt,Q as bt,z as xt,A as De,B as It,K as yt,J as $t,L as Bt,U as kt,p as Pe,f as Y,g as t,b as we,a as Te,s as f,c,r as o,h as ve,t as M,e as z,M as We}from"../chunks/DKDpRE7g.js";import{d as Ce,s as q}from"../chunks/CQBbwnrn.js";import{i as Q}from"../chunks/PbJpwx8q.js";import{t as wt,s as Ee,c as Ye,b as Pt,o as Ke}from"../chunks/Cs5HLVpE.js";import{s as Ne,a as B}from"../chunks/DSW42VuP.js";import{D as g,e as he,i as _e,I as Tt}from"../chunks/CRa7tc_X.js";import{w as me,d as j,g as ke}from"../chunks/DRXOzK2u.js";import{r as et,b as Xe,L as qt,s as Rt}from"../chunks/BCod4-4X.js";import{p as Ze}from"../chunks/BlFFt1pI.js";import{i as St}from"../chunks/CaJYm0qw.js";function Me(p,a,e){De&&It();var r=p,n=kt,s,i=_t()?gt:bt;xt(()=>{i(n,n=a())&&(s&&yt(s),s=$t(()=>e(r)))}),De&&(r=Bt)}function Qe(p,a,e,r){var n=p.__style;if(De||n!==a){var s=wt(a);(!De||s!==p.getAttribute("style"))&&(s==null?p.removeAttribute("style"):p.style.cssText=s),p.__style=a}return r}const Et=!1,Nt=({params:p,url:a})=>{const{id:e}=p,r=Number(e),n=a.searchParams.get("depth"),s=a.searchParams.get("targetAmount");return{recipeId:r,depth:n&&parseInt(n)||1,targetAmount:s&&parseInt(s)||1}},Gr=Object.freeze(Object.defineProperty({__proto__:null,load:Nt,prerender:Et},Symbol.toStringTag,{value:"Module"})),At=()=>{const p=localStorage==null?void 0:localStorage.getItem("defaultTiers");if(p){const a=JSON.parse(p);return me(a)}},fe={defaultTier:At()??me({Smelt:1,Assemble:.75,Research:1,Chemical:1,Refine:1,Particle:1,Fractionate:1,Proliferator:1}),availableTiers:{Smelt:[1,2],Assemble:[.75,1,1.5,3],Research:[1],Refine:[1],Chemical:[1,2],Particle:[1],Fractionate:[1],Proliferator:[.125,.2,.25]}};class Ot{constructor(a,e,r,n,s,i,l){this.recipeId=a,this.itemId=e,this.targetAmount=r,this.targetInterval=n,this.tier=s,this.proliferator=i,this.timeSpend=l}}const Be=(p,a)=>{const e={...p};return Object.entries(a).forEach(([r,n])=>{const s=Number(r);e[s]=(e[s]??0)+n}),e};class Ve extends Ot{constructor(e,r,n,s,i=0,l=1,m){var R;const d=!!(r&&(g.canBeExtracted[r]||g.canBeMined[r]));!e&&!d&&(e=(R=g.alternativeRecipe[r])==null?void 0:R[0]);const _=me(e),u=e?g.recipe[e]:void 0;let b=u==null?void 0:u.Results.findIndex($=>r===$);const k=!r;!r&&(b??-1)>=0&&(r=u==null?void 0:u.Results[b??0]);const S=me(r),v=me((u==null?void 0:u.ResultCounts[b??0])??m??1),x=n?j([S,n],([$,C])=>C[$]):v,y=me(u!=null&&u.Type?ke(fe.defaultTier)[u.Type]:1),P=me(ke(fe.defaultTier).Proliferator),L=me(0),w=j([_,y],([$,C])=>{var F;return((F=g.recipe[$])==null?void 0:F.TimeSpend)/C});s||(s=j([L,w],([$,C])=>$>0?$:C));super(_,S,x,s,y,P,w);A(this,"amountEditable");A(this,"manualAmount",me());A(this,"manualInterval");A(this,"children",me([]));A(this,"canBeMined",j(this.itemId,e=>g.canBeMined[e]));A(this,"canBeExtracted",j(this.itemId,e=>g.canBeExtracted[e]));A(this,"item",j(this.itemId,e=>g.item[e]));A(this,"recipe",j(this.recipeId,e=>g.recipe[e]));A(this,"options",j(this.itemId,e=>g.alternativeRecipe[e]));A(this,"timeSpendChanged",j(this.timeSpend,(e,r)=>{r(!!e);const n=setTimeout(()=>r(!e),1400);return()=>clearTimeout(n)}));A(this,"relativeSpeed",j([this.targetInterval,this.timeSpend],([e,r])=>e/r));A(this,"requiredBuildings",j([this.targetAmount,this.recipe,this.itemId,this.relativeSpeed,this.proliferator],([e,r,n,s,i])=>{const l=r==null?void 0:r.Results.findIndex(d=>n===d),m=e/(r==null?void 0:r.ResultCounts[l])/s;return isNaN(m)?e:m}));A(this,"providedItemsPerInterval",j([this.recipe,this.relativeSpeed,this.requiredBuildings,this.itemId,this.targetAmount],([e,r,n,s,i])=>{if(!e&&s&&(g.canBeMined[s]||g.canBeExtracted[s]))return{[s]:i};const l={};return e==null||e.Results.forEach((m,d)=>{l[m]=e.ResultCounts[d]*r*n}),l}));A(this,"childrenProvideItemsPerInterval",j(this.children,(e,r)=>{const n=new Array(e.length),s=e.map((l,m)=>l.providedItemsPerInterval.subscribe(d=>{n[m]=d;const _=n.filter(u=>!!u).reduce((u,b)=>Be(u,b),{});r(_)})),i=n.filter(l=>!!l).reduce((l,m)=>Be(l,m),{});return r(i),()=>s.forEach(l=>l())}));A(this,"requiredBuildingsByRecipeId",j([this.children,this.recipeId,this.requiredBuildings],([e,r,n],s)=>{const i=new Array(e.length),l=e.map((d,_)=>d.requiredBuildingsByRecipeId.subscribe(u=>{i[_]=u;const b=i.filter(k=>!!k).reduce((k,S)=>Be(k,S),{});if(r){const k=r;b[k]=(b[k]??0)+n}s(b)})),m=i.filter(d=>!!d).reduce((d,_)=>Be(d,_),{});if(r){const d=r;m[d]=(m[d]??0)+n}return s(m),()=>l.forEach(d=>d())}));A(this,"fabsByType",j(this.requiredBuildingsByRecipeId,e=>Object.entries(e).reduce((r,[n,s])=>{const i=Number(n),l=g.recipe[i].Type;return r[l]=(r[l]??0)+Math.round(s),r},{})));A(this,"childrenByItemId",j(this.children,(e,r)=>{const n=new Array(e.length),s=e.map((l,m)=>l.itemId.subscribe(d=>{n[m]=[d,l];const _=n.filter(u=>!!u).reduce((u,[b,k])=>(u[b]=k,u),{});r(_)})),i=n.filter(l=>!!l).reduce((l,[m,d])=>(l[m]=d,l),{});return r(i),()=>s.forEach(l=>l())}));A(this,"requiredItemsPerInterval",j([this.recipe,this.relativeSpeed,this.requiredBuildings],([e,r,n])=>{const s={};return e==null||e.Items.forEach((i,l)=>s[i]=e.ItemCounts[l]*r*n),s}));A(this,"deficitRequiredItemsPerInterval",j([this.recipe,this.relativeSpeed,this.requiredBuildings],([e,r,n])=>{const s={};return e==null||e.Items.forEach((i,l)=>s[i]=-(e.ItemCounts[l]*r*n)),s}));A(this,"inputsOutputs",j([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval],([e,r,n])=>{const s=new Set;return Object.keys(r).forEach(i=>{s.add(Number(i))}),Object.keys(e??{}).forEach(i=>{s.add(Number(i))}),Object.keys(n).forEach(i=>{s.add(Number(i))}),s}));A(this,"surplus",j([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval,this.itemId],([e,r,n,s])=>{const i=Be(e,n);return Object.entries(r).forEach(([l,m])=>i[Number(l)]=(i[Number(l)]??0)-m),Object.entries(i).filter(([,l])=>l<=0).forEach(([l])=>delete i[Number(l)]),i}));A(this,"deficit",j([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval],([e,r])=>{const n={...e};return Object.entries(r).forEach(([s,i])=>n[Number(s)]=(n[Number(s)]??0)-i),Object.entries(n).filter(([,s])=>s>=0).forEach(([s])=>delete n[Number(s)]),n}));A(this,"deficitByItemId",j([this.children,this.deficit,this.recipeId,this.itemId,this.targetAmount],([e,r,n,s,i],l)=>{const m=new Array(e.length),d=e.map((u,b)=>u.deficitByItemId.subscribe(k=>{m[b]=k;const S=m.filter(v=>!!v).reduce((v,x)=>Be(v,x),n?r:{[s]:-i});l(S)})),_=m.filter(u=>!!u).reduce((u,b)=>Be(u,b),n?r:{[s]:-i});return l(_),()=>d.forEach(u=>u())}));A(this,"totals",j([this.itemId,this.requiredBuildings,this.children],([e,r,n])=>{const s={};return s[e]=r,n.map(i=>i.totals).forEach(i=>{Object.entries(i).forEach(([l,m])=>{const d=Number(l);s[d]=(s[d]??0)+m})}),s}));this.depth=i,this.amountEditable=k,this.manualAmount=v,this.manualInterval=L,l>i&&this.children.set(this.dbd(l))}setAmount(e){this.manualAmount.set(e)}setRecipeId(e){this.recipeId.set(e),this.expand()}deleteChild(e){this.children.update(r=>{const n=r.findIndex(s=>ke(s.itemId)===e);return r.splice(n,1),r})}setInterval(e){this.manualInterval.set(e)}expand(){this.children.set(this.dbd())}planFor(e){this.children.update(r=>(r.push(new Ve(void 0,e,this.requiredItemsPerInterval,this.targetInterval,this.depth+1)),r))}dbd(e){const r=[],n=ke(this.recipe);return n==null||n.Items.forEach((s,i)=>{var d;if(!((d=g.alternativeRecipe[s])!=null&&d.length))return;const l=new Ve(void 0,s,this.requiredItemsPerInterval,this.targetInterval,this.depth+1,e);r.push(l);const m=ke(l.providedItemsPerInterval);Object.entries(m).forEach(([_,u])=>{})}),r}}var Ct=(p,a,e)=>a(t(e)),jt=I("<button> </button>"),Dt=I('<div><span class="text-xs text-gray-400">Tier</span> <!></div>'),Mt=(p,a)=>ve(a,!0),Vt=I('<button class="text-center min-w-16 h-10 rounded-l-lg bg-slate-800 hover:bg-slate-600 py-2 px-3 flex justify-around items-end gap-2 relative "><span class="text-xs text-gray-400 absolute top-0"> </span> <b class="bottom-0.5 absolute"> </b></button>');function zt(p,a){Pe(a,!0);const[e,r]=Ne(),n=()=>B(l,"$recipe",e),s=()=>B(m,"$tier",e),i=()=>B(d,"$requiredBuildings",e);let{recipe:l,tier:m,requiredBuildings:d}=a.planner,_=we(!1);const u=x=>{a.planner.tier.set(x),ve(_,!1)};var b=xe(),k=Y(b);{var S=x=>{var y=Dt(),P=f(c(y),2);he(P,1,()=>fe.availableTiers[n().Type],_e,(L,w)=>{var R=jt();let $;R.__click=[Ct,u,w];var C=c(R,!0);o(R),M(F=>{$=Ee(R,1,"px-2 py-1 outline-slate-600 hover:bg-slate-600 text-sm  rounded",null,$,F),q(C,t(w))},[()=>({"outline-1":t(w)===s(),active:t(w)===s()})]),h(L,R)}),o(y),h(x,y)},v=x=>{var y=Vt();y.__click=[Mt,_];var P=c(y),L=c(P);o(P);var w=f(P,2),R=c(w,!0);o(w),o(y),M($=>{q(L,`tier ${s()??""}`),q(R,$)},[()=>Math.round(i()*100)/100]),h(x,y)};Q(k,x=>{t(_)?x(S):x(v,!1)})}h(p,b),Te(),r()}Ce(["click"]);var Ft=I('<div class="flex gap-4 hover:bg-gray-700"><span> </span> <span class="text-right flex-grow"> </span></div>'),Lt=I('<div class="flex odd:bg-gray-950 gap-2 px-2 items-center hover:bg-gray-700"><span class="w-14 text-right"> </span> <span class="text-slate-300 text-xs">x</span> <span> </span> <span class="text-slate-400 text-xs"> </span> <em class="text-right flex-grow"> </em></div>'),Jt=I('<div class="flex gap-4 hover:bg-gray-700 px-1"><span> </span> <span class="text-right flex-grow"> </span></div>'),Ut=I('<div><h3 class="bg-blue-800 py-2 px-4  text-center "><span class="w-14 text-right"> </span> <span class="text-xs text-slate-400">x</span> </h3> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Buildings</h5> <div class="mb-4 my-4 mx-auto  grid grid-cols-2 gap-x-8 justify-center"></div> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Recipes</h5> <!> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">ingress</h5> <div class="mx-auto  grid grid-cols-2 gap-x-8 justify-center"></div></div>');function Gt(p,a){Pe(a,!0);const[e,r]=Ne(),n=()=>B(k,"$requiredBuildings",e),s=()=>B(b,"$recipe",e),i=()=>B(u,"$fabsByType",e),l=()=>B(_,"$requiredBuildingsByRecipeId",e),m=()=>B(v,"$defaultTier",e),d=()=>B(S,"$deficitByItemId",e);let{requiredBuildingsByRecipeId:_,fabsByType:u,recipe:b,requiredBuildings:k,deficitByItemId:S}=a.planner,{defaultTier:v}=fe;var x=Ut(),y=c(x),P=c(y),L=c(P,!0);o(P);var w=f(P,3);o(y);var R=f(y,4);he(R,5,()=>Object.entries(i()),_e,(F,J)=>{var T=Ft();const U=z(()=>{const[X,V]=t(J);return{fabType:X,requiredFabs:V}});var W=c(T),G=c(W,!0);o(W);var se=f(W,2),ie=c(se,!0);o(se),o(T),M(()=>{q(G,t(U).fabType),q(ie,t(U).requiredFabs)}),h(F,T)}),o(R);var $=f(R,4);he($,1,()=>Object.entries(l()??{}),_e,(F,J,T,U)=>{var W=xe();const G=z(()=>{const[X,V]=t(J);return{recipeId:X,requiredBuildings:V}});var se=Y(W);{var ie=X=>{var V=Lt();const ae=z(()=>g.recipe[Number(t(G).recipeId)]),ge=z(()=>m()[t(ae).Type]/t(ae).TimeSpend),O=z(()=>t(ae).ResultCounts.reduce((Re,Le)=>Le+Re,0)),Z=z(()=>t(G).requiredBuildings*t(ge)*t(O)*60);var H=c(V),le=c(H,!0);o(H);var pe=f(H,4),ze=c(pe,!0);o(pe);var Ae=f(pe,2),Fe=c(Ae);o(Ae);var qe=f(Ae,2),je=c(qe);o(qe),o(V),M(()=>{var Re;q(le,t(G).requiredBuildings),q(ze,((Re=t(ae))==null?void 0:Re.Name)??"recipe"+t(G).recipeId),q(Fe,`tier ${m()[t(ae).Type]??""}`),q(je,`${t(Z)??""}/s`)}),h(X,V)};Q(se,X=>{t(G).recipeId&&X(ie)})}h(F,W)});var C=f($,4);he(C,5,()=>Object.entries(d()),_e,(F,J)=>{var T=Jt();const U=z(()=>{const[X,V]=t(J);return{itemId:X,missing:V}});var W=c(T),G=c(W,!0);o(W);var se=f(W,2),ie=c(se,!0);o(se),o(T),M(X=>{q(G,g.item[t(U).itemId].Name),q(ie,X)},[()=>Math.abs(t(U).missing)]),h(F,T)}),o(C),o(x),M(()=>{q(L,n()),q(w,` ${s().Name??""}`)}),h(p,x),Te(),r()}var Kt=(p,a)=>ve(a,!1),Qt=(p,a)=>ve(a,!1),Zt=I('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2 fixed "><!> <button class="bg-green-800 hover:bg-green-700 py-2 rounded-xl mt-auto">close</button></dialog> <button class="fixed overscroll-contain w-screen h-screen backdrop-blur-2xl bg-black opacity-70 top-0 left-0 z-40" aria-label="close"></button>',1),Ht=(p,a)=>a.deletecb(),Wt=I(`<style scoped="">input::-webkit-outer-spin-button,
          input::-webkit-inner-spin-button {
              /* display: none; <- Crashes Chrome on hover */
              -webkit-appearance: none;
              margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
          }

          input[type=number] {
              -moz-appearance: textfield;
          }</style> <input type="number" class="text-left rounded-r-lg w-16">`,1),Xt=I('<div class="flex items-center"><span class="pl-2">🗑️</span>️ <span class="text-sm py-2 block pr-4"> </span></div>'),Yt=I("<option>extraction/mining</option>"),er=I("<option> </option>"),tr=I(" <select><!><!></select>",1),rr=(p,a)=>ve(a,!0),ar=I('<button class="py-1 rounded-xl px-4 bg-slate-800 hover:bg-slate-700">🔎</button>'),sr=I('<span class="flex-grow"> </span> <!>',1),nr=(p,a,e,r)=>{var n;return t(a)<0&&((n=g.producedVia[t(e)])==null?void 0:n.length)>0&&r.planner.planFor(t(e))},ir=I('<div class="flex items-center"><span class="pl-2">📝</span>️ <span class="text-sm py-2 block pr-4"> </span></div>'),lr=I('<div class="flex items-center"><span class="px-3.5"></span>️ <span class="text-sm py-2 block pr-4"> </span></div>'),or=I("<div><!></div>"),dr=I('<div class="flex gap-2 hover:bg-gray-700"><button><!></button> <!></div>'),cr=I('<div class="flex flex-col gap-0.5 "></div>'),ur=I('<!> <div class="flex gap-1 max-w-2xl items-center hover:bg-gray-700"><button class="bg-slate-800 hover:bg-red-700  text-center rounded-r-lg  "><!></button> <div class="flex-grow px-4"><h5 class="flex"><!></h5></div> <!></div> <!>',1);function tt(p,a){Pe(a,!0);const[e,r]=Ne(),n=()=>B(J,"$targetAmount",e),s=()=>B(w,"$recipeId",e),i=()=>B(P,"$itemId",e),l=()=>B(ie,"$options",e),m=()=>B(y,"$item",e),d=()=>B(L,"$recipe",e),_=()=>B(C,"$children",e),u=()=>B($,"$requiredBuildings",e),b=()=>B(G,"$inputsOutputs",e),k=()=>B(U,"$providedItemsPerInterval",e),S=()=>B(T,"$childrenProvideItemsPerInterval",e),v=()=>B(W,"$requiredItemsPerInterval",e),x=()=>B(F,"$childrenByItemId",e);let{item:y,itemId:P,recipe:L,recipeId:w,targetInterval:R,requiredBuildings:$,children:C,childrenByItemId:F,targetAmount:J,childrenProvideItemsPerInterval:T,providedItemsPerInterval:U,requiredItemsPerInterval:W,inputsOutputs:G,deficit:se,options:ie,tier:X}=a.planner,V=we(Ze(n())),ae=we(Ze(s())),ge=we(!1);We(()=>{a.planner.amountEditable&&n()!==t(V)&&a.planner.setAmount(t(V))}),We(()=>{t(ae)!==s()&&a.planner.setRecipeId(t(ae))});var O=ur(),Z=Y(O);{var H=E=>{var D=Zt(),K=Y(D),N=c(K);Gt(N,{get planner(){return a.planner}});var ce=f(N,2);ce.__click=[Kt,ge],o(K);var ee=f(K,2);ee.__click=[Qt,ge],h(E,D)};Q(Z,E=>{t(ge)&&E(H)})}var le=f(Z,2),pe=c(le);pe.__click=[Ht,a];var ze=c(pe);{var Ae=E=>{var D=Wt(),K=f(Y(D),2);et(K),Ye(K,()=>t(V),N=>ve(V,N)),h(E,D)},Fe=E=>{var D=Xt(),K=f(c(D),2),N=c(K,!0);o(K),o(D),M(ce=>{Qe(K,`padding-left: ${a.planner.depth*1.1}rem`),q(N,ce)},[()=>Math.round(n()*100)/100]),h(E,D)};Q(ze,E=>{a.planner.amountEditable?E(Ae):E(Fe,!1)})}o(pe);var qe=f(pe,2),je=c(qe),Re=c(je);{var Le=E=>{var D=tr(),K=Y(D),N=f(K),ce=c(N);{var ee=oe=>{var te=Yt();te.value=(te.__value=void 0)==null?"":void 0,M(()=>Xe(te,s()===void 0)),h(oe,te)};Q(ce,oe=>{(g.canBeExtracted[i()]||g.canBeMined[i()])&&oe(ee)})}var ue=f(ce);he(ue,1,l,_e,(oe,te)=>{var de=er(),Ie={},Je=c(de,!0);o(de),M(()=>{Ie!==(Ie=g.recipe[t(te)].ID)&&(de.value=(de.__value=g.recipe[t(te)].ID)==null?"":g.recipe[t(te)].ID),Xe(de,w===g.recipe[t(te)].ID),q(Je,g.recipe[t(te)].Name)}),h(oe,de)}),o(N),M(()=>q(K,`${m().Name??""}: `)),Pt(N,()=>t(ae),oe=>ve(ae,oe)),h(E,D)},rt=E=>{var D=sr(),K=Y(D),N=c(K,!0);o(K);var ce=f(K,2);{var ee=ue=>{var oe=ar();oe.__click=[rr,ge],h(ue,oe)};Q(ce,ue=>{_().length>1&&!a.planner.amountEditable&&ue(ee)})}M(()=>{var ue;return q(N,(ue=d())==null?void 0:ue.Name)}),h(E,D)};Q(Re,E=>{i()&&(l().length>1||l().length>=1&&g.canBeExtracted[i()]||g.canBeMined[i()])?E(Le):E(rt,!1)})}o(je),o(qe);var at=f(qe,2);{var st=E=>{zt(E,{get planner(){return a.planner}})};Q(at,E=>{u()&&s()&&E(st)})}o(le);var nt=f(le,2);{var it=E=>{var D=cr();he(D,5,b,_e,(K,N)=>{var ce=xe();const ee=z(()=>{var te,de,Ie;return(((te=k())==null?void 0:te[t(N)])??0)+(((de=S())==null?void 0:de[t(N)])??0)-(((Ie=v())==null?void 0:Ie[t(N)])??0)}),ue=z(()=>x()[t(N)]);var oe=Y(ce);Me(oe,()=>t(N),te=>{var de=xe(),Ie=Y(de);{var Je=Se=>{tt(Se,{get planner(){return t(ue)},deletecb:()=>a.planner.deleteChild(t(N))})},lt=Se=>{var Ue=dr(),Oe=c(Ue);let He;Oe.__click=[nr,ee,N,a];var ot=c(Oe);{var dt=re=>{var ne=ir(),be=f(c(ne),2),ye=c(be,!0);o(be),o(ne),M($e=>{Qe(be,`padding-left: ${(a.planner.depth+.5)*1.1}rem`),q(ye,$e)},[()=>Math.round(t(ee)*100)/100]),h(re,ne)},ct=(re,ne)=>{{var be=ye=>{var $e=lr(),Ge=f(c($e),2),pt=c(Ge,!0);o(Ge),o($e),M(mt=>{Qe(Ge,`padding-left: ${(a.planner.depth+.5)*1.1}rem`),q(pt,mt)},[()=>Math.round(t(ee)*100)/100]),h(ye,$e)};Q(re,ye=>{t(N)!==i()&&t(ee)!==0&&ye(be)},ne)}};Q(ot,re=>{var ne;t(ee)<0&&((ne=g.producedVia[t(N)])==null?void 0:ne.length)>0?re(dt):re(ct,!1)})}o(Oe);var ut=f(Oe,2);{var vt=re=>{var ne=or();let be;var ye=c(ne);Tt(ye,{get itemId(){return t(N)}}),o(ne),M($e=>be=Ee(ne,1,"flex gap-2 items-center ",null,be,$e),[()=>({"text-green-500":t(ee)>0,"text-red-500":t(ee)<0})]),h(re,ne)};Q(ut,re=>{t(N)!==i()&&t(ee)!==0&&re(vt)})}o(Ue),M(re=>He=Ee(Oe,1,"bg-slate-800  text-center rounded-r-lg",null,He,re),[()=>{var re;return{"hover:bg-green-800":t(ee)<0&&((re=g.producedVia[t(N)])==null?void 0:re.length)>0}}]),h(Se,Ue)};Q(Ie,Se=>{t(ue)?Se(Je):Se(lt,!1)})}h(te,de)}),h(K,ce)}),o(D),h(E,D)};Q(nt,E=>{var D;((D=b())==null?void 0:D.size)>0&&E(it)})}h(p,O),Te(),r()}Ce(["click"]);var vr=I('<div class="flex flex-col items-stretch group w-full "><a class="my-2 z-30 hover:bg-slate-700 w-xs"> </a></div>'),pr=I('<div class="flex gap-0.5 flex-col mb-4 sticky top-0 mr-2 backdrop-blur-3xl backdrop-opacity-75  z-40"><!> <label for="recipeName">ingredient or recipe name</label><input id="recipeName"></div> <!>',1);function mr(p,a){Pe(a,!0);let e=we(Ze([])),r=Ke(),n=Ke(),s=Ke(),i=we(""),l=z(()=>t(i)?g.items.filter(v=>v.Name.toLowerCase().includes(t(i).toLowerCase())).map(v=>v.ID):[]),m=z(()=>(()=>{const v=new Set;return t(l).forEach(x=>{for(const y of g.relatedRecipes[x]??[])v.add(y)}),v})()),d=z(()=>g.recipees.filter(v=>t(e).length>0?t(e).includes(v.Type):!0).filter(v=>t(i)?t(m).has(v.ID):!0).filter(v=>r.checked===null?!0:r.checked?g.buildableRecipees.has(v.ID):!g.buildableRecipees.has(v.ID)).filter(v=>n.checked===null?!0:n.checked?g.fluidRecipees.has(v.ID):!g.fluidRecipees.has(v.ID)).filter(v=>s.checked===null?!0:s.checked?g.entityRecipees.has(v.ID):!g.entityRecipees.has(v.ID)));new Set(g.recipees.map(v=>v.Type));var _=pr(),u=Y(_),b=c(u);Q(b,v=>{});var k=f(b,3);et(k),o(u);var S=f(u,2);he(S,17,()=>t(d),_e,(v,x)=>{var y=vr(),P=c(y),L=c(P,!0);o(P),o(y),M(w=>{Rt(P,"href",w),q(L,t(x).Name)},[()=>qt.recipe(t(x).ID)]),h(v,y)}),Ye(k,()=>t(i),v=>ve(i,v)),h(p,_),Te()}Ce(["click"]);var fr=(p,a,e,r)=>a(t(e),t(r)),hr=I('<button class="flex-grow shadow-xl py-2 m-4 outline-amber-100 outline-1 active bg-slate-500 hover:bg-slate-400  text-white rounded-lg"> </button>'),_r=(p,a,e,r)=>a(t(e),t(r)),gr=I('<button class="flex-grow shadow-xl py-2 m-4	bg-slate-800 hover:bg-slate-700 text-gray-300 rounded-lg"> </button>'),br=I('<div><h4 class="bg-blue-900 py-2 px-4 rounded-t"> </h4> <div class="flex bg-gray-600 "></div></div>'),xr=I('<h3 class="bg-blue-800  rounded-t py-5 px-4">default tier for new factories</h3> <!>',1);function Ir(p,a){Pe(a,!1);const[e,r]=Ne(),n=()=>B(s,"$defaultTierReadable",e);let s=fe.defaultTier;n();const i=(d,_)=>{const u={...n(),[d]:_};localStorage.setItem("defaultTiers",JSON.stringify(u)),fe.defaultTier.set(u)};St();var l=xr(),m=f(Y(l),2);he(m,1,()=>Object.keys(n()),_e,(d,_)=>{var u=xe(),b=Y(u);{var k=S=>{var v=br(),x=c(v),y=c(x,!0);o(x);var P=f(x,2);he(P,5,()=>fe.availableTiers[t(_)],_e,(L,w)=>{var R=xe(),$=Y(R);{var C=J=>{var T=hr();T.__click=[fr,i,_,w];var U=c(T,!0);o(T),M(()=>q(U,t(w))),h(J,T)},F=J=>{var T=gr();T.__click=[_r,i,_,w];var U=c(T,!0);o(T),M(()=>q(U,t(w))),h(J,T)};Q($,J=>{t(w)===n()[t(_)]?J(C):J(F,!1)})}h(L,R)}),o(P),o(v),M(()=>q(y,t(_))),h(S,v)};Q(b,S=>{var v;((v=fe.availableTiers[t(_)])==null?void 0:v.length)>1&&S(k)})}h(d,u)}),h(p,l),Te(),r()}Ce(["click"]);var yr=I('<div class="flex odd:bg-gray-950 gap-2 px-2"><span class="flex-grow"> </span> <span> </span> <em> </em></div>'),$r=I('<div class="max-w-sm flex flex-col mr-auto gap-0.5"><h4 class="px-4 py-2 bg-slate-800 rounded-t-lg">all required buildings</h4> <!></div>');function Br(p,a){Pe(a,!0);const[e,r]=Ne(),n=()=>B(m,"$itemId",e),s=()=>B(l,"$requiredBuildingsByRecipeId",e),i=()=>B(d,"$defaultTier",e);let{requiredBuildingsByRecipeId:l,itemId:m}=a.planner,{defaultTier:d}=fe;var _=$r(),u=f(c(_),2);Me(u,n,b=>{var k=xe(),S=Y(k);he(S,1,()=>Object.entries(s()),_e,(v,x)=>{var y=xe();const P=z(()=>{const[R,$]=t(x);return{recipeId:R,requiredBuildings:$}});var L=Y(y);{var w=R=>{var $=yr();const C=z(()=>g.recipe[Number(t(P).recipeId)]),F=z(()=>i()[t(C).Type]/t(C).TimeSpend),J=z(()=>t(C).ResultCounts.reduce((V,ae)=>ae+V,0)),T=z(()=>t(P).requiredBuildings*t(F)*t(J)*60);var U=c($),W=c(U,!0);o(U);var G=f(U,2),se=c(G,!0);o(G);var ie=f(G,2),X=c(ie);o(ie),o($),M(()=>{var V;q(W,((V=t(C))==null?void 0:V.Name)??"recipe"+t(P).recipeId),q(se,t(P).requiredBuildings),q(X,`${t(T)??""}/s`)}),h(R,$)};Q(L,R=>{t(P).recipeId&&R(w)})}h(v,y)}),h(b,k)}),o(_),h(p,_),Te(),r()}var kr=(p,a)=>a(),wr=(p,a)=>ve(a,!1),Pr=I('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2"><!> <span class="flex-grow"></span> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to existing</button> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to future</button></dialog>'),Tr=(p,a)=>t(a).setInterval(0),qr=(p,a,e)=>t(a).setInterval(e),Rr=(p,a)=>t(a).setInterval(60),Sr=I("<button>Second</button>"),Er=(p,a)=>ve(a,!0),Nr=I(`<!> <div class="flex gap-12"><div class="max-w-sm lg:block hidden max-h-screen  ml-auto overflow-y-auto"><!></div> <div class="max-w-2xl w-full lg:mx-0 mx-auto"><div class="flex  text-sm py-1"><span class="px-3 py-1 bg-slate-800 rounded-r-lg">Items per <span class="inline-flex"><button> </button> <button>Minute</button> <!></span></span> <span class="px-3 py-3 flex-grow text-right"></span> <button class="px-3 py-3 bg-slate-800 hover:bg-slate-700 rounded-l-lg">⚙️
				Required Fabs to Process
				Items</button></div> <!></div> <!></div>`,1);function Kr(p,a){Pe(a,!0);const[e,r]=Ne(),n=()=>B(m,"$defaultTier",e),s=()=>B(t(b),"$timeSpendChanged",e),i=()=>B(t(_),"$targetInterval",e),l=()=>B(t(u),"$timeSpend",e);let{defaultTier:m}=fe,d=z(()=>new Ve(a.data.recipeId,void 0,void 0,void 0,void 0,a.data.depth,a.data.targetAmount)),_=z(()=>t(d).targetInterval),u=z(()=>t(d).timeSpend),b=z(()=>t(d).timeSpendChanged);const k=60*60;let S=we(!1);const v=O=>{O||(O=t(d));const Z=ke(O.recipe);if(Z){const H=Z.Type,le=n()[H];O.tier.set(le)}ke(O.children).forEach(H=>v(H)),ve(S,!1)};var x=Nr(),y=Y(x);{var P=O=>{var Z=Pr(),H=c(Z);Ir(H,{});var le=f(H,4);le.__click=[kr,v];var pe=f(le,2);pe.__click=[wr,S],o(Z),h(O,Z)};Q(y,O=>{t(S)&&O(P)})}var L=f(y,2),w=c(L),R=c(w);mr(R,{}),o(w);var $=f(w,2),C=c($),F=c(C),J=f(c(F)),T=c(J);let U;T.__click=[Tr,d];var W=c(T);o(T);var G=f(T,2);let se;G.__click=[qr,d,k];var ie=f(G,2);{var X=O=>{var Z=Sr();let H;Z.__click=[Rr,d],M(le=>H=Ee(Z,1,"px-1.5 py-2 multi hover:bg-slate-700",null,H,le),[()=>({active:i()===60})]),h(O,Z)};Q(ie,O=>{l()!==60&&O(X)})}o(J),o(F);var V=f(F,4);V.__click=[Er,S],o(C);var ae=f(C,2);Me(ae,()=>t(d),O=>{tt(O,{get planner(){return t(d)}})}),o($);var ge=f($,2);Me(ge,()=>t(d),O=>{Br(O,{get planner(){return t(d)}})}),o(L),M((O,Z,H)=>{U=Ee(T,1,"px-1.5 py-2 multi hover:bg-slate-700",null,U,O),q(W,`Cycle (${Z??""}s)`),se=Ee(G,1,"px-1.5 py-2 multi hover:bg-slate-700",null,se,H)},[()=>({"animate-flash":s(),active:i()===l()}),()=>Math.round(l()/60*100)/100,()=>({active:i()===k})]),h(p,x),Te(),r()}Ce(["click"]);export{Kr as component,Gr as universal};
