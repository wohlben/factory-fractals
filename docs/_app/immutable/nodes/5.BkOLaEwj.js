var bt=Object.defineProperty;var xt=(p,a,e)=>a in p?bt(p,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):p[a]=e;var O=(p,a,e)=>xt(p,typeof a!="symbol"?a+"":a,e);import{c as be,a as g,t as I}from"../chunks/e-TftYpV.js";import{at as It,aG as yt,Q as Bt,z as $t,A as Ve,B as kt,K as wt,J as Pt,L as Tt,U as qt,p as qe,f as X,g as t,b as Pe,a as Re,s as f,c,r as o,h as ce,t as j,e as F,M as Xe}from"../chunks/DKDpRE7g.js";import{d as Me,s as N}from"../chunks/CQBbwnrn.js";import{i as K}from"../chunks/PbJpwx8q.js";import{t as Rt,s as Te,c as et,b as St,o as Qe}from"../chunks/Cs5HLVpE.js";import{s as Oe,a as B}from"../chunks/DSW42VuP.js";import{D as _,e as me,i as fe,I as Et}from"../chunks/CRa7tc_X.js";import{w as ve,d as M,g as we}from"../chunks/DRXOzK2u.js";import{r as tt,L as rt,s as at,b as Ye}from"../chunks/BCod4-4X.js";import{p as He}from"../chunks/BlFFt1pI.js";import{i as Nt}from"../chunks/CaJYm0qw.js";function ze(p,a,e){Ve&&kt();var r=p,n=qt,s,i=It()?yt:Bt;$t(()=>{i(n,n=a())&&(s&&wt(s),s=Pt(()=>e(r)))}),Ve&&(r=Tt)}function Ze(p,a,e,r){var n=p.__style;if(Ve||n!==a){var s=Rt(a);(!Ve||s!==p.getAttribute("style"))&&(s==null?p.removeAttribute("style"):p.style.cssText=s),p.__style=a}return r}const At=!1,Ot=({params:p,url:a})=>{const{id:e}=p,r=Number(e),n=a.searchParams.get("depth"),s=a.searchParams.get("targetAmount");return{recipeId:r,depth:n&&parseInt(n)||1,targetAmount:s&&parseInt(s)||1}},Qr=Object.freeze(Object.defineProperty({__proto__:null,load:Ot,prerender:At},Symbol.toStringTag,{value:"Module"})),Ct=()=>{const p=localStorage==null?void 0:localStorage.getItem("defaultTiers");if(p){const a=JSON.parse(p);return ve(a)}},pe={defaultTier:Ct()??ve({Smelt:1,Assemble:.75,Research:1,Chemical:1,Refine:1,Particle:1,Fractionate:1,Proliferator:1}),availableTiers:{Smelt:[1,2],Assemble:[.75,1,1.5,3],Research:[1],Refine:[1],Chemical:[1,2],Particle:[1],Fractionate:[1],Proliferator:[.125,.2,.25]}};class Mt{constructor(a,e,r,n,s,i,l){this.recipeId=a,this.itemId=e,this.targetAmount=r,this.targetInterval=n,this.tier=s,this.proliferator=i,this.timeSpend=l}}const ke=(p,a)=>{const e={...p};return Object.entries(a).forEach(([r,n])=>{const s=Number(r);e[s]=(e[s]??0)+n}),e};class Fe extends Mt{constructor(e,r,n,s,i=0,l=1,m){var R;const d=!!(r&&(_.canBeExtracted[r]||_.canBeMined[r]));!e&&!d&&(e=(R=_.alternativeRecipe[r])==null?void 0:R[0]);const h=ve(e),u=e?_.recipe[e]:void 0;let b=u==null?void 0:u.Results.findIndex(w=>r===w);const $=!r;!r&&(b??-1)>=0&&(r=u==null?void 0:u.Results[b??0]);const A=ve(r),v=ve((u==null?void 0:u.ResultCounts[b??0])??m??1),x=n?M([A,n],([w,C])=>C[w]):v,y=ve(u!=null&&u.Type?we(pe.defaultTier)[u.Type]:1),P=ve(we(pe.defaultTier).Proliferator),L=ve(0),k=M([h,y],([w,C])=>{var D;return((D=_.recipe[w])==null?void 0:D.TimeSpend)/C});s||(s=M([L,k],([w,C])=>w>0?w:C));super(h,A,x,s,y,P,k);O(this,"amountEditable");O(this,"manualAmount",ve());O(this,"manualInterval");O(this,"children",ve([]));O(this,"canBeMined",M(this.itemId,e=>_.canBeMined[e]));O(this,"canBeExtracted",M(this.itemId,e=>_.canBeExtracted[e]));O(this,"item",M(this.itemId,e=>_.item[e]));O(this,"recipe",M(this.recipeId,e=>_.recipe[e]));O(this,"options",M(this.itemId,e=>_.alternativeRecipe[e]));O(this,"timeSpendChanged",M(this.timeSpend,(e,r)=>{r(!!e);const n=setTimeout(()=>r(!e),1400);return()=>clearTimeout(n)}));O(this,"relativeSpeed",M([this.targetInterval,this.timeSpend],([e,r])=>e/r));O(this,"requiredBuildings",M([this.targetAmount,this.recipe,this.itemId,this.relativeSpeed,this.proliferator],([e,r,n,s,i])=>{const l=r==null?void 0:r.Results.findIndex(d=>n===d),m=e/(r==null?void 0:r.ResultCounts[l])/s;return isNaN(m)?e:m}));O(this,"providedItemsPerInterval",M([this.recipe,this.relativeSpeed,this.requiredBuildings,this.itemId,this.targetAmount],([e,r,n,s,i])=>{if(!e&&s&&(_.canBeMined[s]||_.canBeExtracted[s]))return{[s]:i};const l={};return e==null||e.Results.forEach((m,d)=>{l[m]=e.ResultCounts[d]*r*n}),l}));O(this,"childrenProvideItemsPerInterval",M(this.children,(e,r)=>{const n=new Array(e.length),s=e.map((l,m)=>l.providedItemsPerInterval.subscribe(d=>{n[m]=d;const h=n.filter(u=>!!u).reduce((u,b)=>ke(u,b),{});r(h)})),i=n.filter(l=>!!l).reduce((l,m)=>ke(l,m),{});return r(i),()=>s.forEach(l=>l())}));O(this,"requiredBuildingsByRecipeId",M([this.children,this.recipeId,this.requiredBuildings],([e,r,n],s)=>{const i=new Array(e.length),l=e.map((d,h)=>d.requiredBuildingsByRecipeId.subscribe(u=>{i[h]=u;const b=i.filter($=>!!$).reduce(($,A)=>ke($,A),{});if(r){const $=r;b[$]=(b[$]??0)+n}s(b)})),m=i.filter(d=>!!d).reduce((d,h)=>ke(d,h),{});if(r){const d=r;m[d]=(m[d]??0)+n}return s(m),()=>l.forEach(d=>d())}));O(this,"fabsByType",M(this.requiredBuildingsByRecipeId,e=>Object.entries(e).reduce((r,[n,s])=>{const i=Number(n),l=_.recipe[i].Type;return r[l]=(r[l]??0)+Math.ceil(s),r},{})));O(this,"childrenByItemId",M(this.children,(e,r)=>{const n=new Array(e.length),s=e.map((l,m)=>l.itemId.subscribe(d=>{n[m]=[d,l];const h=n.filter(u=>!!u).reduce((u,[b,$])=>(u[b]=$,u),{});r(h)})),i=n.filter(l=>!!l).reduce((l,[m,d])=>(l[m]=d,l),{});return r(i),()=>s.forEach(l=>l())}));O(this,"requiredItemsPerInterval",M([this.recipe,this.relativeSpeed,this.requiredBuildings],([e,r,n])=>{const s={};return e==null||e.Items.forEach((i,l)=>s[i]=e.ItemCounts[l]*r*n),s}));O(this,"deficitRequiredItemsPerInterval",M([this.recipe,this.relativeSpeed,this.requiredBuildings],([e,r,n])=>{const s={};return e==null||e.Items.forEach((i,l)=>s[i]=-(e.ItemCounts[l]*r*n)),s}));O(this,"inputsOutputs",M([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval],([e,r,n])=>{const s=new Set;return Object.keys(r).forEach(i=>{s.add(Number(i))}),Object.keys(e??{}).forEach(i=>{s.add(Number(i))}),Object.keys(n).forEach(i=>{s.add(Number(i))}),s}));O(this,"surplus",M([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval,this.itemId],([e,r,n,s])=>{const i=ke(e,n);return Object.entries(r).forEach(([l,m])=>i[Number(l)]=(i[Number(l)]??0)-m),Object.entries(i).filter(([,l])=>l<=0).forEach(([l])=>delete i[Number(l)]),i}));O(this,"deficit",M([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval],([e,r])=>{const n={...e};return Object.entries(r).forEach(([s,i])=>n[Number(s)]=(n[Number(s)]??0)-i),Object.entries(n).filter(([,s])=>s>=0).forEach(([s])=>delete n[Number(s)]),n}));O(this,"deficitByItemId",M([this.children,this.deficit,this.recipeId,this.itemId,this.targetAmount],([e,r,n,s,i],l)=>{const m=new Array(e.length),d=e.map((u,b)=>u.deficitByItemId.subscribe($=>{m[b]=$;const A=m.filter(v=>!!v).reduce((v,x)=>ke(v,x),n?r:{[s]:-i});l(A)})),h=m.filter(u=>!!u).reduce((u,b)=>ke(u,b),n?r:{[s]:-i});return l(h),()=>d.forEach(u=>u())}));O(this,"totals",M([this.itemId,this.requiredBuildings,this.children],([e,r,n])=>{const s={};return s[e]=r,n.map(i=>i.totals).forEach(i=>{Object.entries(i).forEach(([l,m])=>{const d=Number(l);s[d]=(s[d]??0)+m})}),s}));this.depth=i,this.amountEditable=$,this.manualAmount=v,this.manualInterval=L,l>i&&this.children.set(this.dbd(l))}setAmount(e){this.manualAmount.set(e)}setRecipeId(e){this.recipeId.set(e),this.expand()}deleteChild(e){this.children.update(r=>{const n=r.findIndex(s=>we(s.itemId)===e);return r.splice(n,1),r})}setInterval(e){this.manualInterval.set(e)}expand(){this.children.set(this.dbd())}planFor(e){this.children.update(r=>(r.push(new Fe(void 0,e,this.requiredItemsPerInterval,this.targetInterval,this.depth+1)),r))}dbd(e){const r=[],n=we(this.recipe);return n==null||n.Items.forEach((s,i)=>{var d;if(!((d=_.alternativeRecipe[s])!=null&&d.length))return;const l=new Fe(void 0,s,this.requiredItemsPerInterval,this.targetInterval,this.depth+1,e);r.push(l);const m=we(l.providedItemsPerInterval);Object.entries(m).forEach(([h,u])=>{})}),r}}var jt=(p,a,e)=>a(t(e)),Dt=I("<button> </button>"),Vt=I('<div><span class="text-xs text-gray-400">Tier</span> <!></div>'),zt=(p,a)=>ce(a,!0),Ft=I('<button class="text-center min-w-16 h-10 rounded-l-lg bg-slate-800 hover:bg-slate-600 py-2 px-3 flex justify-around items-end gap-2 relative "><span class="text-xs text-gray-400 absolute top-0"> </span> <b class="bottom-0.5 absolute"> </b></button>');function Lt(p,a){qe(a,!0);const[e,r]=Oe(),n=()=>B(l,"$recipe",e),s=()=>B(m,"$tier",e),i=()=>B(d,"$requiredBuildings",e);let{recipe:l,tier:m,requiredBuildings:d}=a.planner,h=Pe(!1);const u=x=>{a.planner.tier.set(x),ce(h,!1)};var b=be(),$=X(b);{var A=x=>{var y=Vt(),P=f(c(y),2);me(P,1,()=>pe.availableTiers[n().Type],fe,(L,k)=>{var R=Dt();let w;R.__click=[jt,u,k];var C=c(R,!0);o(R),j(D=>{w=Te(R,1,"px-2 py-1 outline-slate-600 hover:bg-slate-600 text-sm  rounded",null,w,D),N(C,t(k))},[()=>({"outline-1":t(k)===s(),active:t(k)===s()})]),g(L,R)}),o(y),g(x,y)},v=x=>{var y=Ft();y.__click=[zt,h];var P=c(y),L=c(P);o(P);var k=f(P,2),R=c(k,!0);o(k),o(y),j(w=>{N(L,`tier ${s()??""}`),N(R,w)},[()=>Math.round(i()*100)/100]),g(x,y)};K($,x=>{t(h)?x(A):x(v,!1)})}g(p,b),Re(),r()}Me(["click"]);var Jt=I('<div class="flex gap-4 hover:bg-gray-700"><span> </span> <span class="text-right flex-grow"> </span></div>'),Ut=I('<div class="flex odd:bg-gray-950 gap-2 px-2 items-center hover:bg-gray-700 "><span class="w-14 text-right"> </span> <span class="text-slate-300 text-xs">x</span> <span> </span> <span class="text-slate-400 text-xs"> </span> <em class="text-right flex-grow"> </em></div>'),Gt=I('<div class="flex gap-4 hover:bg-gray-700 px-1"><span> </span></div>'),Kt=I('<div><h3 class="bg-blue-800 py-2 px-4  text-center "><span class="w-14 text-right"> </span> <span class="text-xs text-slate-400">x</span> </h3> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Buildings</h5> <div class="mb-4 my-4 mx-auto  grid grid-cols-2 gap-x-8 justify-center px-0.5"></div> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Recipes</h5> <!> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">ingress</h5> <div class="mx-auto  grid grid-cols-2 gap-x-8 justify-center px-0.5"></div></div>');function Qt(p,a){qe(a,!0);const[e,r]=Oe(),n=()=>B($,"$requiredBuildings",e),s=()=>B(b,"$recipe",e),i=()=>B(u,"$fabsByType",e),l=()=>B(h,"$requiredBuildingsByRecipeId",e),m=()=>B(v,"$defaultTier",e),d=()=>B(A,"$deficitByItemId",e);let{requiredBuildingsByRecipeId:h,fabsByType:u,recipe:b,requiredBuildings:$,deficitByItemId:A}=a.planner,{defaultTier:v}=pe;var x=Kt(),y=c(x),P=c(y),L=c(P,!0);o(P);var k=f(P,3);o(y);var R=f(y,4);me(R,5,()=>Object.entries(i()),fe,(D,J)=>{var T=Jt();const Q=F(()=>{const[ne,ae]=t(J);return{fabType:ne,requiredFabs:ae}});var Y=c(T),U=c(Y,!0);o(Y);var se=f(Y,2),he=c(se,!0);o(se),o(T),j(()=>{N(U,t(Q).fabType),N(he,t(Q).requiredFabs)}),g(D,T)}),o(R);var w=f(R,4);me(w,1,()=>Object.entries(l()??{}),fe,(D,J,T,Q)=>{var Y=be();const U=F(()=>{const[ne,ae]=t(J);return{recipeId:ne,requiredBuildings:ae}});var se=X(Y);{var he=ne=>{var ae=Ut();const W=F(()=>_.recipe[Number(t(U).recipeId)]),oe=F(()=>m()[t(W).Type]/t(W).TimeSpend),S=F(()=>t(W).ResultCounts.reduce((Ie,Ee)=>Ee+Ie,0)),H=F(()=>t(U).requiredBuildings*t(oe)*t(S)*60);var Z=c(ae),ue=c(Z,!0);o(Z);var ge=f(Z,4),xe=c(ge,!0);o(ge);var Se=f(ge,2),Le=c(Se);o(Se);var je=f(Se,2),Je=c(je);o(je),o(ae),j((Ie,Ee)=>{var De;N(ue,Ie),N(xe,((De=t(W))==null?void 0:De.Name)??"recipe"+t(U).recipeId),N(Le,`tier ${m()[t(W).Type]??""}`),N(Je,`${Ee??""}/s`)},[()=>Math.round(t(U).requiredBuildings*100)/100,()=>Math.round(t(H)*100)/100]),g(ne,ae)};K(se,ne=>{t(U).recipeId&&ne(he)})}g(D,Y)});var C=f(w,4);me(C,5,()=>Object.entries(d()),fe,(D,J)=>{var T=Gt();const Q=F(()=>{const[se]=t(J);return{itemId:se}});var Y=c(T),U=c(Y,!0);o(Y),o(T),j(()=>N(U,_.item[t(Q).itemId].Name)),g(D,T)}),o(C),o(x),j(D=>{N(L,D),N(k,` ${s().Name??""}`)},[()=>Math.round(n()*100)/100]),g(p,x),Re(),r()}var Zt=(p,a)=>ce(a,!1),Ht=(p,a)=>ce(a,!1),Wt=I('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2 fixed "><!> <button class="bg-green-800 hover:bg-green-700 py-2 rounded-xl mt-auto">close</button></dialog> <button class="fixed overscroll-contain w-screen h-screen backdrop-blur-2xl bg-black opacity-70 top-0 left-0 z-40" aria-label="close"></button>',1),Xt=(p,a)=>{var e;return(e=a.deletecb)==null?void 0:e.call(a)},Yt=I(`<style scoped="">input::-webkit-outer-spin-button,
          input::-webkit-inner-spin-button {
              /* display: none; <- Crashes Chrome on hover */
              -webkit-appearance: none;
              margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
          }

          input[type=number] {
              -moz-appearance: textfield;
          }</style> <input type="number" class="text-left rounded-r-lg w-16">`,1),er=I('<div class="flex items-center"><span class="pl-2">ğŸ—‘ï¸</span>ï¸ <span class="text-sm py-2 block pr-4"> </span></div>'),tr=I("<option>extraction/mining</option>"),rr=I("<option> </option>"),ar=I(" <select><!><!></select>",1),sr=(p,a)=>ce(a,!0),nr=I('<button class="py-1 rounded-xl px-4 bg-slate-800 hover:bg-slate-700">ğŸ”</button>'),ir=I('<span class="flex-grow"> <a class="bg-gray-800 hover:bg-slate-700">â¡ï¸</a></span> <!>',1),lr=(p,a,e,r)=>{var n;return t(a)<0&&((n=_.producedVia[t(e)])==null?void 0:n.length)>0&&r.planner.planFor(t(e))},or=I('<div class="flex items-center"><span class="pl-2">ğŸ“</span>ï¸ <span class="text-sm py-2 block pr-4"> </span></div>'),dr=I('<div class="flex items-center"><span class="px-3.5"></span>ï¸ <span class="text-sm py-2 block pr-4"> </span></div>'),cr=I("<div><!></div>"),ur=I('<div class="flex gap-2 hover:bg-gray-700"><button><!></button> <!></div>'),vr=I('<div class="flex flex-col gap-0.5 "></div>'),pr=I('<!> <div class="flex gap-1 max-w-2xl items-center hover:bg-gray-700"><button><!></button> <div class="flex-grow px-4"><h5 class="flex"><!></h5></div> <!></div> <!>',1);function st(p,a){qe(a,!0);const[e,r]=Oe(),n=()=>B(T,"$targetAmount",e),s=()=>B(k,"$recipeId",e),i=()=>B(P,"$itemId",e),l=()=>B(ne,"$options",e),m=()=>B(y,"$item",e),d=()=>B(L,"$recipe",e),h=()=>B(C,"$requiredBuildings",e),u=()=>B(D,"$children",e),b=()=>B(se,"$inputsOutputs",e),$=()=>B(Y,"$providedItemsPerInterval",e),A=()=>B(Q,"$childrenProvideItemsPerInterval",e),v=()=>B(U,"$requiredItemsPerInterval",e),x=()=>B(J,"$childrenByItemId",e);let{item:y,itemId:P,recipe:L,recipeId:k,targetInterval:R,relativeSpeed:w,requiredBuildings:C,children:D,childrenByItemId:J,targetAmount:T,childrenProvideItemsPerInterval:Q,providedItemsPerInterval:Y,requiredItemsPerInterval:U,inputsOutputs:se,deficit:he,options:ne,tier:ae}=a.planner,W=Pe(He(n())),oe=Pe(He(s())),S=Pe(!1);Xe(()=>{a.planner.amountEditable&&n()!==t(W)&&a.planner.setAmount(t(W))}),Xe(()=>{t(oe)!==s()&&a.planner.setRecipeId(t(oe))});var H=pr(),Z=X(H);{var ue=q=>{var V=Wt(),G=X(V),E=c(G);Qt(E,{get planner(){return a.planner}});var de=f(E,2);de.__click=[Zt,S],o(G);var ee=f(G,2);ee.__click=[Ht,S],g(q,V)};K(Z,q=>{t(S)&&q(ue)})}var ge=f(Z,2),xe=c(ge);xe.__click=[Xt,a];let Se;var Le=c(xe);{var je=q=>{var V=Yt(),G=f(X(V),2);tt(G),et(G,()=>t(W),E=>ce(W,E)),g(q,V)},Je=q=>{var V=er(),G=f(c(V),2),E=c(G,!0);o(G),o(V),j(de=>{Ze(G,`padding-left: ${a.planner.depth*1.1}rem`),N(E,de)},[()=>Math.round(n()*100)/100]),g(q,V)};K(Le,q=>{a.planner.amountEditable?q(je):q(Je,!1)})}o(xe);var Ie=f(xe,2),Ee=c(Ie),De=c(Ee);{var nt=q=>{var V=ar(),G=X(V),E=f(G),de=c(E);{var ee=te=>{var z=tr();z.value=(z.__value=void 0)==null?"":void 0,j(()=>Ye(z,s()===void 0)),g(te,z)};K(de,te=>{(_.canBeExtracted[i()]||_.canBeMined[i()])&&te(ee)})}var Ne=f(de);me(Ne,1,l,fe,(te,z)=>{var le=rr(),ye={},Ue=c(le,!0);o(le),j(()=>{ye!==(ye=_.recipe[t(z)].ID)&&(le.value=(le.__value=_.recipe[t(z)].ID)==null?"":_.recipe[t(z)].ID),Ye(le,k===_.recipe[t(z)].ID),N(Ue,_.recipe[t(z)].Name)}),g(te,le)}),o(E),j(()=>N(G,`${m().Name??""}: `)),St(E,()=>t(oe),te=>ce(oe,te)),g(q,V)},it=q=>{var V=ir(),G=X(V),E=c(G),de=f(E);o(G);var ee=f(G,2);{var Ne=te=>{var z=nr();z.__click=[sr,S],g(te,z)};K(ee,te=>{u().length>1&&!a.planner.amountEditable&&te(Ne)})}j(te=>{var z;N(E,`${((z=d())==null?void 0:z.Name)??""} `),at(de,"href",te)},[()=>rt.recipe(d().ID)+"?targetAmount="+Math.round(h())+"&depth=10"]),g(q,V)};K(De,q=>{i()&&(l().length>1||l().length>=1&&_.canBeExtracted[i()]||_.canBeMined[i()])?q(nt):q(it,!1)})}o(Ee),o(Ie);var lt=f(Ie,2);{var ot=q=>{Lt(q,{get planner(){return a.planner}})};K(lt,q=>{h()&&s()&&q(ot)})}o(ge);var dt=f(ge,2);{var ct=q=>{var V=vr();me(V,5,b,fe,(G,E)=>{var de=be();const ee=F(()=>{var z,le,ye;return(((z=$())==null?void 0:z[t(E)])??0)+(((le=A())==null?void 0:le[t(E)])??0)-(((ye=v())==null?void 0:ye[t(E)])??0)}),Ne=F(()=>x()[t(E)]);var te=X(de);ze(te,()=>t(E),z=>{var le=be(),ye=X(le);{var Ue=Ae=>{st(Ae,{get planner(){return t(Ne)},deletecb:()=>a.planner.deleteChild(t(E))})},ut=Ae=>{var Ge=ur(),Ce=c(Ge);let We;Ce.__click=[lr,ee,E,a];var vt=c(Ce);{var pt=re=>{var ie=or(),_e=f(c(ie),2),Be=c(_e,!0);o(_e),o(ie),j($e=>{Ze(_e,`padding-left: ${(a.planner.depth+.5)*1.1}rem`),N(Be,$e)},[()=>Math.round(t(ee)*100)/100]),g(re,ie)},mt=(re,ie)=>{{var _e=Be=>{var $e=dr(),Ke=f(c($e),2),gt=c(Ke,!0);o(Ke),o($e),j(_t=>{Ze(Ke,`padding-left: ${(a.planner.depth+.5)*1.1}rem`),N(gt,_t)},[()=>Math.round(t(ee)*100)/100]),g(Be,$e)};K(re,Be=>{t(E)!==i()&&t(ee)!==0&&Be(_e)},ie)}};K(vt,re=>{var ie;t(ee)<0&&((ie=_.producedVia[t(E)])==null?void 0:ie.length)>0?re(pt):re(mt,!1)})}o(Ce);var ft=f(Ce,2);{var ht=re=>{var ie=cr();let _e;var Be=c(ie);Et(Be,{get itemId(){return t(E)}}),o(ie),j($e=>_e=Te(ie,1,"flex gap-2 items-center ",null,_e,$e),[()=>({"text-green-500":t(ee)>0,"text-red-500":t(ee)<0})]),g(re,ie)};K(ft,re=>{t(E)!==i()&&t(ee)!==0&&re(ht)})}o(Ge),j(re=>We=Te(Ce,1,"bg-slate-800  text-center rounded-r-lg",null,We,re),[()=>{var re;return{"hover:bg-green-800":t(ee)<0&&((re=_.producedVia[t(E)])==null?void 0:re.length)>0}}]),g(Ae,Ge)};K(ye,Ae=>{t(Ne)?Ae(Ue):Ae(ut,!1)})}g(z,le)}),g(G,de)}),o(V),g(q,V)};K(dt,q=>{var V;((V=b())==null?void 0:V.size)>0&&q(ct)})}j(q=>Se=Te(xe,1,"bg-slate-800  text-center rounded-r-lg  ",null,Se,q),[()=>({"hover:bg-red-700":!a.planner.amountEditable})]),g(p,H),Re(),r()}Me(["click"]);var mr=I('<div class="flex flex-col items-stretch group w-full "><a class="my-2 z-30 hover:bg-slate-700 w-xs"> </a></div>'),fr=I('<div class="flex gap-0.5 flex-col mb-4 sticky top-0 mr-2 backdrop-blur-3xl backdrop-opacity-75  z-40"><!> <label for="recipeName">ingredient or recipe name</label><input id="recipeName"></div> <!>',1);function hr(p,a){qe(a,!0);let e=Pe(He([])),r=Qe(),n=Qe(),s=Qe(),i=Pe(""),l=F(()=>t(i)?_.items.filter(v=>v.Name.toLowerCase().includes(t(i).toLowerCase())).map(v=>v.ID):[]),m=F(()=>(()=>{const v=new Set;return t(l).forEach(x=>{for(const y of _.relatedRecipes[x]??[])v.add(y)}),v})()),d=F(()=>_.recipees.filter(v=>t(e).length>0?t(e).includes(v.Type):!0).filter(v=>t(i)?t(m).has(v.ID):!0).filter(v=>r.checked===null?!0:r.checked?_.buildableRecipees.has(v.ID):!_.buildableRecipees.has(v.ID)).filter(v=>n.checked===null?!0:n.checked?_.fluidRecipees.has(v.ID):!_.fluidRecipees.has(v.ID)).filter(v=>s.checked===null?!0:s.checked?_.entityRecipees.has(v.ID):!_.entityRecipees.has(v.ID)));new Set(_.recipees.map(v=>v.Type));var h=fr(),u=X(h),b=c(u);K(b,v=>{});var $=f(b,3);tt($),o(u);var A=f(u,2);me(A,17,()=>t(d),fe,(v,x)=>{var y=mr(),P=c(y),L=c(P,!0);o(P),o(y),j(k=>{at(P,"href",k),N(L,t(x).Name)},[()=>rt.recipe(t(x).ID)]),g(v,y)}),et($,()=>t(i),v=>ce(i,v)),g(p,h),Re()}Me(["click"]);var gr=(p,a,e,r)=>a(t(e),t(r)),_r=I('<button class="flex-grow shadow-xl py-2 m-4 outline-amber-100 outline-1 active bg-slate-500 hover:bg-slate-400  text-white rounded-lg"> </button>'),br=(p,a,e,r)=>a(t(e),t(r)),xr=I('<button class="flex-grow shadow-xl py-2 m-4	bg-slate-800 hover:bg-slate-700 text-gray-300 rounded-lg"> </button>'),Ir=I('<div><h4 class="bg-blue-900 py-2 px-4 rounded-t"> </h4> <div class="flex bg-gray-600 "></div></div>'),yr=I('<h3 class="bg-blue-800  rounded-t py-5 px-4">default tier for new factories</h3> <!>',1);function Br(p,a){qe(a,!1);const[e,r]=Oe(),n=()=>B(s,"$defaultTierReadable",e);let s=pe.defaultTier;n();const i=(d,h)=>{const u={...n(),[d]:h};localStorage.setItem("defaultTiers",JSON.stringify(u)),pe.defaultTier.set(u)};Nt();var l=yr(),m=f(X(l),2);me(m,1,()=>Object.keys(n()),fe,(d,h)=>{var u=be(),b=X(u);{var $=A=>{var v=Ir(),x=c(v),y=c(x,!0);o(x);var P=f(x,2);me(P,5,()=>pe.availableTiers[t(h)],fe,(L,k)=>{var R=be(),w=X(R);{var C=J=>{var T=_r();T.__click=[gr,i,h,k];var Q=c(T,!0);o(T),j(()=>N(Q,t(k))),g(J,T)},D=J=>{var T=xr();T.__click=[br,i,h,k];var Q=c(T,!0);o(T),j(()=>N(Q,t(k))),g(J,T)};K(w,J=>{t(k)===n()[t(h)]?J(C):J(D,!1)})}g(L,R)}),o(P),o(v),j(()=>N(y,t(h))),g(A,v)};K(b,A=>{var v;((v=pe.availableTiers[t(h)])==null?void 0:v.length)>1&&A($)})}g(d,u)}),g(p,l),Re(),r()}Me(["click"]);var $r=I('<div class="flex odd:bg-gray-950 gap-2 px-2"><span class="flex-grow"> </span> <span> </span> <em> </em></div>'),kr=I('<div class="md:max-w-sm w-full flex flex-col mx-auto lg:ml-0 gap-0.5"><h4 class="px-4 py-2 bg-slate-800 rounded-t-lg">all required buildings</h4> <!></div>');function wr(p,a){qe(a,!0);const[e,r]=Oe(),n=()=>B(m,"$itemId",e),s=()=>B(l,"$requiredBuildingsByRecipeId",e),i=()=>B(d,"$defaultTier",e);let{requiredBuildingsByRecipeId:l,itemId:m}=a.planner,{defaultTier:d}=pe;var h=kr(),u=f(c(h),2);ze(u,n,b=>{var $=be(),A=X($);me(A,1,()=>Object.entries(s()),fe,(v,x)=>{var y=be();const P=F(()=>{const[R,w]=t(x);return{recipeId:R,requiredBuildings:w}});var L=X(y);{var k=R=>{var w=$r();const C=F(()=>_.recipe[Number(t(P).recipeId)]),D=F(()=>i()[t(C).Type]/t(C).TimeSpend),J=F(()=>t(C).ResultCounts.reduce((ae,W)=>W+ae,0)),T=F(()=>t(P).requiredBuildings*t(D)*t(J)*60);var Q=c(w),Y=c(Q,!0);o(Q);var U=f(Q,2),se=c(U,!0);o(U);var he=f(U,2),ne=c(he);o(he),o(w),j((ae,W)=>{var oe;N(Y,((oe=t(C))==null?void 0:oe.Name)??"recipe"+t(P).recipeId),N(se,ae),N(ne,`${W??""}/s`)},[()=>Math.round(t(P).requiredBuildings*100)/100,()=>Math.round(t(T)*100)/100]),g(R,w)};K(L,R=>{t(P).recipeId&&R(k)})}g(v,y)}),g(b,$)}),o(h),g(p,h),Re(),r()}var Pr=(p,a)=>a(),Tr=(p,a)=>ce(a,!1),qr=I('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2"><!> <span class="flex-grow"></span> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to existing</button> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to future</button></dialog>'),Rr=(p,a)=>t(a).setInterval(0),Sr=(p,a,e)=>t(a).setInterval(e),Er=(p,a)=>t(a).setInterval(60),Nr=I("<button>Second</button>"),Ar=(p,a)=>ce(a,!0),Or=I(`<!> <div class="flex gap-12 flex-wrap lg:flex-nowrap"><div class="lg:max-w-sm lg:block hidden max-h-screen  ml-auto overflow-y-auto"><!></div> <div class="max-w-2xl w-full lg:mx-0 mx-auto"><div class="flex  text-sm py-1"><span class="px-3 py-1 bg-slate-800 rounded-r-lg">Items per <span class="inline-flex"><button> </button> <button>Minute</button> <!></span></span> <span class="px-3 py-3 flex-grow text-right"></span> <button class="px-3 py-3 bg-slate-800 hover:bg-slate-700 rounded-l-lg">âš™ï¸
				Required Fabs to Process
				Items</button></div> <!></div> <!></div>`,1);function Zr(p,a){qe(a,!0);const[e,r]=Oe(),n=()=>B(m,"$defaultTier",e),s=()=>B(t(b),"$timeSpendChanged",e),i=()=>B(t(h),"$targetInterval",e),l=()=>B(t(u),"$timeSpend",e);let{defaultTier:m}=pe,d=F(()=>new Fe(a.data.recipeId,void 0,void 0,void 0,void 0,a.data.depth,a.data.targetAmount)),h=F(()=>t(d).targetInterval),u=F(()=>t(d).timeSpend),b=F(()=>t(d).timeSpendChanged);const $=60*60;let A=Pe(!1);const v=S=>{S||(S=t(d));const H=we(S.recipe);if(H){const Z=H.Type,ue=n()[Z];S.tier.set(ue)}we(S.children).forEach(Z=>v(Z)),ce(A,!1)};var x=Or(),y=X(x);{var P=S=>{var H=qr(),Z=c(H);Br(Z,{});var ue=f(Z,4);ue.__click=[Pr,v];var ge=f(ue,2);ge.__click=[Tr,A],o(H),g(S,H)};K(y,S=>{t(A)&&S(P)})}var L=f(y,2),k=c(L),R=c(k);hr(R,{}),o(k);var w=f(k,2),C=c(w),D=c(C),J=f(c(D)),T=c(J);let Q;T.__click=[Rr,d];var Y=c(T);o(T);var U=f(T,2);let se;U.__click=[Sr,d,$];var he=f(U,2);{var ne=S=>{var H=Nr();let Z;H.__click=[Er,d],j(ue=>Z=Te(H,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Z,ue),[()=>({active:i()===60})]),g(S,H)};K(he,S=>{l()!==60&&S(ne)})}o(J),o(D);var ae=f(D,4);ae.__click=[Ar,A],o(C);var W=f(C,2);ze(W,()=>t(d),S=>{st(S,{get planner(){return t(d)}})}),o(w);var oe=f(w,2);ze(oe,()=>t(d),S=>{wr(S,{get planner(){return t(d)}})}),o(L),j((S,H,Z)=>{Q=Te(T,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Q,S),N(Y,`Cycle (${H??""}s)`),se=Te(U,1,"px-1.5 py-2 multi hover:bg-slate-700",null,se,Z)},[()=>({"animate-flash":s(),active:i()===l()}),()=>Math.round(l()/60*100)/100,()=>({active:i()===$})]),g(p,x),Re(),r()}Me(["click"]);export{Zr as component,Qr as universal};
