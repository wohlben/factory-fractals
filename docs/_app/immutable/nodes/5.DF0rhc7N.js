var It=Object.defineProperty;var yt=(u,r,t)=>r in u?It(u,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[r]=t;var z=(u,r,t)=>yt(u,typeof r!="symbol"?r+"":r,t);import{c as Ee,a as p,t as x,b as We}from"../chunks/BmHjAyxW.js";import{au as kt,aH as Bt,X as wt,z as $t,A as Ye,B as Pt,K as Rt,J as Tt,L as qt,U as St,p as Ae,f as ie,g as e,b as Ne,a as Oe,s as v,c as d,r as o,h as ce,t as N,e as y,M as ot,aI as Et}from"../chunks/B-82rzdC.js";import{d as Ge,s as F,a as Nt}from"../chunks/D897dbaB.js";import{i as A}from"../chunks/BfA0D6Yw.js";import{s as Ue,r as ut,b as dt,L as nt}from"../chunks/h91-G9kU.js";import{t as At,s as Pe,c as vt,b as Ot,o as at}from"../chunks/C3CEGPiq.js";import{s as Ke,a as q}from"../chunks/D2GXNv7x.js";import{D as b,e as ye,i as ke,I as Ct}from"../chunks/gwZSL3j3.js";import{w as $e,d as H,g as Le}from"../chunks/DWHFLt1U.js";import{a as it}from"../chunks/DsntZBoA.js";import{p as st}from"../chunks/Cg9itU8Q.js";function et(u,r,t){Ye&&Pt();var a=u,s=St,n,l=kt()?Bt:wt;$t(()=>{l(s,s=r())&&(n&&Rt(n),n=Tt(()=>t(a)))}),Ye&&(a=qt)}function Qe(u,r,t,a){var s=u.__style;if(Ye||s!==r){var n=At(r);(!Ye||n!==u.getAttribute("style"))&&(n==null?u.removeAttribute("style"):u.style.cssText=n),u.__style=r}return a}const Mt=!1,jt=({params:u,url:r})=>{const{id:t}=u,a=Number(t),s=r.searchParams.get("depth"),n=r.searchParams.get("targetAmount");return{recipeId:a,depth:s&&parseInt(s)||1,targetAmount:n&&parseInt(n)||1}},da=Object.freeze(Object.defineProperty({__proto__:null,load:jt,prerender:Mt},Symbol.toStringTag,{value:"Module"})),Dt=()=>{const u=localStorage==null?void 0:localStorage.getItem("defaultTiers");if(u){const r=JSON.parse(u);return $e(r)}},_e={defaultTier:Dt()??$e({Smelt:1,Assemble:.75,Research:1,Chemical:1,Refine:1,Particle:1,Fractionate:1,Proliferator:1}),availableTiers:{Smelt:[1,2,3],Assemble:[.75,1,1.5,3],Research:[1],Refine:[1],Chemical:[1,2],Particle:[1],Fractionate:[1],Proliferator:[.125,.2,.25]},factoryItems:{Smelt:{1:2302,2:2315,3:2319},Assemble:{.75:2303,1:2304,1.5:2305,3:2318},Research:{1:2901,2:2902},Chemical:{1:2309,2:2317},Refine:{1:2308},Particle:{1:2310},Fractionate:{1:2314},Proliferator:{.125:1141,.2:1142,.25:1143}}};class Vt{constructor(r,t,a,s,n,l,i){this.recipeId=r,this.itemId=t,this.targetAmount=a,this.targetInterval=s,this.tier=n,this.proliferator=l,this.timeSpend=i}}const Fe=(u,r)=>{const t={...u};return Object.entries(r).forEach(([a,s])=>{const n=Number(a);t[n]=(t[n]??0)+s}),t};class tt extends Vt{constructor(t,a,s,n,l=0,i=1,f){var j;const h=!!(a&&(b.canBeExtracted[a]||b.canBeMined[a]));!t&&!h&&(t=(j=b.alternativeRecipe[a])==null?void 0:j[0]);const _=$e(t),c=t?b.recipe[t]:void 0;let w=c==null?void 0:c.Results.findIndex(D=>a===D);const E=!a;!a&&(w??-1)>=0&&(a=c==null?void 0:c.Results[w??0]);const Z=$e(a),m=$e((c==null?void 0:c.ResultCounts[w??0])??f??1),g=s?H([Z,s],([D,le])=>le[D]):m,I=$e(c!=null&&c.Type?Le(_e.defaultTier)[c.Type]:1),O=$e(Le(_e.defaultTier).Proliferator),M=$e(0),$=H([_,I],([D,le])=>{var L;return((L=b.recipe[D])==null?void 0:L.TimeSpend)/le});n||(n=H([M,$],([D,le])=>D>0?D:le));super(_,Z,g,n,I,O,$);z(this,"amountEditable");z(this,"manualAmount",$e());z(this,"manualInterval");z(this,"children",$e([]));z(this,"canBeMined",H(this.itemId,t=>b.canBeMined[t]));z(this,"canBeExtracted",H(this.itemId,t=>b.canBeExtracted[t]));z(this,"item",H(this.itemId,t=>b.item[t]));z(this,"recipe",H(this.recipeId,t=>b.recipe[t]));z(this,"header",H([this.itemId,this.recipe],([t,a])=>{var f;const s=t??((f=a==null?void 0:a.Results)==null?void 0:f[0]);if(!s)return;const n=b.item[s],l=n.IconPath.split("/"),i=l[l.length-1];return i&&[it+`/dsp_sprites/${i}.png`,n.Name]}));z(this,"options",H(this.itemId,t=>b.alternativeRecipe[t]));z(this,"timeSpendChanged",H(this.timeSpend,(t,a)=>{a(!!t);const s=setTimeout(()=>a(!t),1400);return()=>clearTimeout(s)}));z(this,"relativeSpeed",H([this.targetInterval,this.timeSpend],([t,a])=>t/a));z(this,"requiredBuildings",H([this.targetAmount,this.recipe,this.itemId,this.relativeSpeed,this.proliferator],([t,a,s,n,l])=>{const i=a==null?void 0:a.Results.findIndex(h=>s===h),f=t/(a==null?void 0:a.ResultCounts[i])/n;return isNaN(f)?t:f}));z(this,"providedItemsPerInterval",H([this.recipe,this.relativeSpeed,this.requiredBuildings,this.itemId,this.targetAmount],([t,a,s,n,l])=>{if(!t&&n&&(b.canBeMined[n]||b.canBeExtracted[n]))return{[n]:l};const i={};return t==null||t.Results.forEach((f,h)=>{i[f]=t.ResultCounts[h]*a*s}),i}));z(this,"childrenProvideItemsPerInterval",H(this.children,(t,a)=>{const s=new Array(t.length),n=t.map((i,f)=>i.providedItemsPerInterval.subscribe(h=>{s[f]=h;const _=s.filter(c=>!!c).reduce((c,w)=>Fe(c,w),{});a(_)})),l=s.filter(i=>!!i).reduce((i,f)=>Fe(i,f),{});return a(l),()=>n.forEach(i=>i())}));z(this,"requiredBuildingsByRecipeId",H([this.children,this.recipeId,this.requiredBuildings],([t,a,s],n)=>{const l=new Array(t.length),i=t.map((h,_)=>h.requiredBuildingsByRecipeId.subscribe(c=>{l[_]=c;const w=l.filter(E=>!!E).reduce((E,Z)=>Fe(E,Z),{});if(a){const E=a;w[E]=(w[E]??0)+s}n(w)})),f=l.filter(h=>!!h).reduce((h,_)=>Fe(h,_),{});if(a){const h=a;f[h]=(f[h]??0)+s}return n(f),()=>i.forEach(h=>h())}));z(this,"fabsByType",H(this.requiredBuildingsByRecipeId,t=>Object.entries(t).reduce((a,[s,n])=>{const l=Number(s),i=b.recipe[l].Type;return a[i]=(a[i]??0)+Math.ceil(n),a},{})));z(this,"childrenByItemId",H(this.children,(t,a)=>{const s=new Array(t.length),n=t.map((i,f)=>i.itemId.subscribe(h=>{s[f]=[h,i];const _=s.filter(c=>!!c).reduce((c,[w,E])=>(c[w]=E,c),{});a(_)})),l=s.filter(i=>!!i).reduce((i,[f,h])=>(i[f]=h,i),{});return a(l),()=>n.forEach(i=>i())}));z(this,"requiredItemsPerInterval",H([this.recipe,this.relativeSpeed,this.requiredBuildings],([t,a,s])=>{const n={};return t==null||t.Items.forEach((l,i)=>n[l]=t.ItemCounts[i]*a*s),n}));z(this,"deficitRequiredItemsPerInterval",H([this.recipe,this.relativeSpeed,this.requiredBuildings],([t,a,s])=>{const n={};return t==null||t.Items.forEach((l,i)=>n[l]=-(t.ItemCounts[i]*a*s)),n}));z(this,"inputsOutputs",H([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval],([t,a,s])=>{const n=new Set;return Object.keys(a).forEach(l=>{n.add(Number(l))}),Object.keys(t??{}).forEach(l=>{n.add(Number(l))}),Object.keys(s).forEach(l=>{n.add(Number(l))}),n}));z(this,"surplus",H([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval,this.itemId],([t,a,s,n])=>{const l=Fe(t,s);return Object.entries(a).forEach(([i,f])=>l[Number(i)]=(l[Number(i)]??0)-f),Object.entries(l).filter(([,i])=>i<=0).forEach(([i])=>delete l[Number(i)]),l}));z(this,"deficit",H([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval],([t,a])=>{const s={...t};return Object.entries(a).forEach(([n,l])=>s[Number(n)]=(s[Number(n)]??0)-l),Object.entries(s).filter(([,n])=>n>=0).forEach(([n])=>delete s[Number(n)]),s}));z(this,"deficitByItemId",H([this.children,this.deficit,this.recipeId,this.itemId,this.targetAmount],([t,a,s,n,l],i)=>{const f=new Array(t.length),h=t.map((c,w)=>c.deficitByItemId.subscribe(E=>{f[w]=E;const Z=f.filter(m=>!!m).reduce((m,g)=>Fe(m,g),s?a:{[n]:-l});i(Z)})),_=f.filter(c=>!!c).reduce((c,w)=>Fe(c,w),s?a:{[n]:-l});return i(_),()=>h.forEach(c=>c())}));z(this,"totals",H([this.itemId,this.requiredBuildings,this.children],([t,a,s])=>{const n={};return n[t]=a,s.map(l=>l.totals).forEach(l=>{Object.entries(l).forEach(([i,f])=>{const h=Number(i);n[h]=(n[h]??0)+f})}),n}));this.depth=l,this.amountEditable=E,this.manualAmount=m,this.manualInterval=M,i>l&&this.children.set(this.dbd(i))}setAmount(t){this.manualAmount.set(t)}setRecipeId(t){this.recipeId.set(t),this.expand()}deleteChild(t){this.children.update(a=>{const s=a.findIndex(n=>Le(n.itemId)===t);return a.splice(s,1),a})}setInterval(t){this.manualInterval.set(t)}expand(){this.children.set(this.dbd())}planFor(t){this.children.update(a=>(a.push(new tt(void 0,t,this.requiredItemsPerInterval,this.targetInterval,this.depth+1)),a))}dbd(t){const a=[],s=Le(this.recipe);return s==null||s.Items.forEach((n,l)=>{var h;if(!((h=b.alternativeRecipe[n])!=null&&h.length))return;const i=new tt(void 0,n,this.requiredItemsPerInterval,this.targetInterval,this.depth+1,t);a.push(i);const f=Le(i.providedItemsPerInterval);Object.entries(f).forEach(([_,c])=>{})}),a}}var zt=(u,r,t)=>r(e(t)),Ft=x("<button> </button>"),Lt=x('<div><span class="text-xs text-gray-400">Tier</span> <!></div>'),Jt=(u,r)=>ce(r,!0),Ut=x('<button class="text-center min-w-16 h-10 rounded-l-lg bg-slate-800 hover:bg-slate-600 py-2 px-3 flex justify-around items-end gap-2 relative "><span class="text-xs text-gray-400 absolute top-0"> </span> <b class="bottom-0.5 absolute"> </b></button>');function Gt(u,r){Ae(r,!0);const[t,a]=Ke(),s=()=>q(i,"$recipe",t),n=()=>q(f,"$tier",t),l=()=>q(h,"$requiredBuildings",t);let{recipe:i,tier:f,requiredBuildings:h}=r.planner,_=Ne(!1);const c=g=>{r.planner.tier.set(g),ce(_,!1)};var w=Ee(),E=ie(w);{var Z=g=>{var I=Lt(),O=v(d(I),2);ye(O,1,()=>_e.availableTiers[s().Type],ke,(M,$)=>{var j=Ft();let D;j.__click=[zt,c,$];var le=d(j,!0);o(j),N(L=>{D=Pe(j,1,"px-2 py-1 outline-slate-600 hover:bg-slate-600 text-sm  rounded",null,D,L),F(le,e($))},[()=>({"outline-1":e($)===n(),active:e($)===n()})]),p(M,j)}),o(I),p(g,I)},m=g=>{var I=Ut();I.__click=[Jt,_];var O=d(I),M=d(O);o(O);var $=v(O,2),j=d($,!0);o($),o(I),N(D=>{F(M,`tier ${n()??""}`),F(j,D)},[()=>Math.round(l()*100)/100]),p(g,I)};A(E,g=>{e(_)?g(Z):g(m,!1)})}p(u,w),Oe(),a()}Ge(["click"]);var Kt=x('<div class="flex gap-4 hover:bg-gray-700"><span> </span> <span class="text-right flex-grow"> </span></div>'),Ht=x('<div class="flex odd:bg-gray-950 gap-2 px-2 items-center hover:bg-gray-700 "><span class="w-14 text-right"> </span> <span class="text-slate-300 text-xs">x</span> <span> </span> <span class="text-slate-400 text-xs"> </span> <em class="text-right flex-grow"> </em></div>'),Xt=x('<div class="flex gap-4 hover:bg-gray-700 px-1"><span> </span></div>'),Zt=x('<div><h3 class="bg-blue-800 py-2 px-4  text-center "><span class="w-14 text-right"> </span> <span class="text-xs text-slate-400">x</span> </h3> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Buildings</h5> <div class="mb-4 my-4 mx-auto  grid grid-cols-2 gap-x-8 justify-center px-0.5"></div> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Recipes</h5> <!> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">ingress</h5> <div class="mx-auto  grid grid-cols-2 gap-x-8 justify-center px-0.5"></div></div>');function Qt(u,r){Ae(r,!0);const[t,a]=Ke(),s=()=>q(E,"$requiredBuildings",t),n=()=>q(w,"$recipe",t),l=()=>q(c,"$fabsByType",t),i=()=>q(_,"$requiredBuildingsByRecipeId",t),f=()=>q(m,"$defaultTier",t),h=()=>q(Z,"$deficitByItemId",t);let{requiredBuildingsByRecipeId:_,fabsByType:c,recipe:w,requiredBuildings:E,deficitByItemId:Z}=r.planner,{defaultTier:m}=_e;var g=Zt(),I=d(g),O=d(I),M=d(O,!0);o(O);var $=v(O,3);o(I);var j=v(I,4);ye(j,5,()=>Object.entries(l()),ke,(L,G)=>{var ae=Kt();const pe=y(()=>{const[se,C]=e(G);return{fabType:se,requiredFabs:C}});var V=d(ae),Q=d(V,!0);o(V);var W=v(V,2),ne=d(W,!0);o(W),o(ae),N(()=>{F(Q,e(pe).fabType),F(ne,e(pe).requiredFabs)}),p(L,ae)}),o(j);var D=v(j,4);ye(D,1,()=>Object.entries(i()??{}),ke,(L,G,ae,pe)=>{var V=Ee();const Q=y(()=>{const[se,C]=e(G);return{recipeId:se,requiredBuildings:C}});var W=ie(V);{var ne=se=>{var C=Ht();const oe=y(()=>b.recipe[Number(e(Q).recipeId)]),fe=y(()=>f()[e(oe).Type]/e(oe).TimeSpend),Be=y(()=>e(oe).ResultCounts.reduce((ge,Ie)=>Ie+ge,0)),be=y(()=>e(Q).requiredBuildings*e(fe)*e(Be)*60);var k=d(C),X=d(k,!0);o(k);var Y=v(k,4),ue=d(Y,!0);o(Y);var xe=v(Y,2),Re=d(xe);o(xe);var ee=v(xe,2),te=d(ee);o(ee),o(C),N((ge,Ie)=>{var Te;F(X,ge),F(ue,((Te=e(oe))==null?void 0:Te.Name)??"recipe"+e(Q).recipeId),F(Re,`tier ${f()[e(oe).Type]??""}`),F(te,`${Ie??""}/s`)},[()=>Math.round(e(Q).requiredBuildings*100)/100,()=>Math.round(e(be)*100)/100]),p(se,C)};A(W,se=>{e(Q).recipeId&&se(ne)})}p(L,V)});var le=v(D,4);ye(le,5,()=>Object.entries(h()),ke,(L,G)=>{var ae=Xt();const pe=y(()=>{const[W]=e(G);return{itemId:W}});var V=d(ae),Q=d(V,!0);o(V),o(ae),N(()=>F(Q,b.item[e(pe).itemId].Name)),p(L,ae)}),o(le),o(g),N(L=>{F(M,L),F($,` ${n().Name??""}`)},[()=>Math.round(s()*100)/100]),p(u,g),Oe(),a()}var Wt=x('<img class="h-6" alt="">');function je(u,r){Ae(r,!0);let t=y(()=>b.item[r.itemId]);const a=y(()=>{var i;return(i=e(t))==null?void 0:i.IconPath.split("/")}),s=y(()=>e(a)&&e(a)[e(a).length-1]),n=y(()=>e(s)&&it+`/dsp_sprites/${e(s)}.png`);var l=Wt();N(()=>Ue(l,"src",e(n))),p(u,l),Oe()}var Yt=x('<img class="h-6" alt="">');function ct(u,r){Ae(r,!0);const t=y(()=>r.filename.split("/")),a=y(()=>e(t)&&e(t)[e(t).length-1]),s=y(()=>e(a)&&it+`/dsp_sprites/${e(a)}.png`);var n=Yt();N(()=>Ue(n,"src",e(s))),p(u,n),Oe()}var er=(u,r)=>ce(r,!1),tr=(u,r)=>ce(r,!1),rr=x('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2 fixed "><!> <button class="bg-green-800 hover:bg-green-700 py-2 rounded-xl mt-auto">close</button></dialog> <button class="fixed overscroll-contain w-screen h-screen backdrop-blur-2xl bg-black opacity-70 top-0 left-0 z-40" aria-label="close"></button>',1),ar=(u,r)=>{var t;return(t=r.deletecb)==null?void 0:t.call(r)},nr=x(`<style scoped="">input::-webkit-outer-spin-button,
          input::-webkit-inner-spin-button {
              /* display: none; <- Crashes Chrome on hover */
              -webkit-appearance: none;
              margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
          }

          input[type=number] {
              -moz-appearance: textfield;
          }</style> <label class="flex items-center pl-2 gap-1"><!> <input type="number" class="text-left rounded-r-lg w-16 outline-none"></label>`,1),sr=x('<div class="flex items-center"><span class="pl-2">🗑️</span>️ <!> <span class="text-sm py-2 block pr-4"> </span></div>'),ir=x("<option><!> </option>"),lr=x("<option> </option>"),or=x('<a class="bg-gray-800 hover:bg-slate-700">➡️</a>'),dr=x('<select class="my-1 truncate contain-content"><!><!></select> <!>',1),cr=x('<a class="bg-gray-800 hover:bg-slate-700">➡️</a>'),ur=(u,r)=>ce(r,!0),vr=x('<button class="py-1 rounded-xl px-4 bg-slate-800 hover:bg-slate-700">🔎</button>'),pr=x('<span class="flex-grow"> <!></span> <!>',1),fr=x('<div class="ml-auto"><!></div>'),hr=(u,r,t,a)=>{var s;return e(r)<0&&((s=b.producedVia[e(t)])==null?void 0:s.length)>0&&a.planner.planFor(e(t))},mr=x('<div class="flex items-center"><span class="pl-2">📝</span>️ <!> <span class="text-sm py-2 block pr-4"> </span></div>'),gr=x('<div class="flex items-center"><span class="px-3.5"></span>️ <!> <span class="text-sm py-2 block pr-4"> </span></div>'),_r=x("<div><!></div>"),br=x('<div class="flex gap-2 hover:bg-gray-700"><button><!></button> <!></div>'),xr=x('<div class="flex flex-col gap-0.5 "></div>'),Ir=x('<!> <div class="flex gap-1 max-w-2xl items-center hover:bg-gray-700  flex-wrap @container"><button><!></button> <div class="flex-grow px-4 "><div class="flex items-center gap-4"><!></div></div> <!></div> <!>',1);function pt(u,r){Ae(r,!0);const[t,a]=Ke(),s=()=>q(L,"$targetAmount",t),n=()=>q($,"$recipeId",t),l=()=>q(M,"$recipe",t),i=()=>q(O,"$itemId",t),f=()=>q(Q,"$options",t),h=()=>q(I,"$item",t),_=()=>q(j,"$requiredBuildings",t),c=()=>q(D,"$children",t),w=()=>q(V,"$inputsOutputs",t),E=()=>q(ae,"$providedItemsPerInterval",t),Z=()=>q(G,"$childrenProvideItemsPerInterval",t),m=()=>q(pe,"$requiredItemsPerInterval",t),g=()=>q(le,"$childrenByItemId",t);let{item:I,itemId:O,recipe:M,recipeId:$,requiredBuildings:j,children:D,childrenByItemId:le,targetAmount:L,childrenProvideItemsPerInterval:G,providedItemsPerInterval:ae,requiredItemsPerInterval:pe,inputsOutputs:V,options:Q,header:W}=r.planner,ne=Ne(st(s())),se=Ne(st(n())),C=Ne(!1);ot(()=>{r.planner.amountEditable&&s()!==e(ne)&&r.planner.setAmount(e(ne))}),ot(()=>{e(se)!==n()&&r.planner.setRecipeId(e(se))});var oe=Ir(),fe=ie(oe);{var Be=P=>{var T=rr(),K=ie(T),R=d(K);Qt(R,{get planner(){return r.planner}});var de=v(R,2);de.__click=[er,C],o(K);var J=v(K,2);J.__click=[tr,C],p(P,T)};A(fe,P=>{e(C)&&P(Be)})}var be=v(fe,2),k=d(be);k.__click=[ar,r];let X;var Y=d(k);{var ue=P=>{var T=nr(),K=v(ie(T),2),R=d(K);{var de=U=>{ct(U,{get filename(){return l().IconPath}})},J=U=>{const B=y(()=>{var S,re;return(re=(S=l())==null?void 0:S.Results)==null?void 0:re[0]});je(U,{get itemId(){return e(B)}})};A(R,U=>{var B;(B=l())!=null&&B.IconPath?U(de):U(J,!1)})}var he=v(R,2);ut(he),o(K),vt(he,()=>e(ne),U=>ce(ne,U)),p(P,T)},xe=P=>{var T=sr(),K=v(d(T),2);{var R=U=>{ct(U,{get filename(){return l().IconPath}})},de=U=>{je(U,{get itemId(){return i()}})};A(K,U=>{var B;(B=l())!=null&&B.IconPath?U(R):U(de,!1)})}var J=v(K,2),he=d(J,!0);o(J),o(T),N(U=>{Qe(J,`padding-left: ${r.planner.depth*1.1}rem`),F(he,U)},[()=>Math.round(s()*100)/100]),p(P,T)};A(Y,P=>{r.planner.amountEditable?P(ue):P(xe,!1)})}o(k);var Re=v(k,2),ee=d(Re),te=d(ee);{var ge=P=>{var T=dr(),K=ie(T),R=d(K);{var de=B=>{var S=ir();S.value=(S.__value=void 0)==null?"":void 0;var re=d(S);{var Je=we=>{var qe=We("orbital collector");p(we,qe)},Xe=we=>{var qe=We("mining");p(we,qe)};A(re,we=>{b.canBeExtracted[i()]?we(Je):we(Xe,!1)})}var Me=v(re);o(S),N(()=>{dt(S,n()===void 0),F(Me,` (${h().Name??""})`)}),p(B,S)};A(R,B=>{(b.canBeExtracted[i()]||b.canBeMined[i()])&&B(de)})}var J=v(R);ye(J,1,f,ke,(B,S)=>{var re=lr(),Je={},Xe=d(re,!0);o(re),N(()=>{Je!==(Je=b.recipe[e(S)].ID)&&(re.value=(re.__value=b.recipe[e(S)].ID)==null?"":b.recipe[e(S)].ID),dt(re,n()===b.recipe[e(S)].ID),F(Xe,b.recipe[e(S)].Name)}),p(B,re)}),o(K);var he=v(K,2);{var U=B=>{var S=or();N(re=>Ue(S,"href",re),[()=>nt.recipe(l().ID)+"?targetAmount="+Math.round(_())+"&depth=10"]),p(B,S)};A(he,B=>{!r.planner.amountEditable&&l()&&B(U)})}Ot(K,()=>e(se),B=>ce(se,B)),p(P,T)},Ie=P=>{var T=pr(),K=ie(T),R=d(K),de=v(R);{var J=B=>{var S=cr();N(re=>Ue(S,"href",re),[()=>nt.recipe(l().ID)+"?targetAmount="+Math.round(_())+"&depth=10"]),p(B,S)};A(de,B=>{r.planner.amountEditable||B(J)})}o(K);var he=v(K,2);{var U=B=>{var S=vr();S.__click=[ur,C],p(B,S)};A(he,B=>{c().length>1&&!r.planner.amountEditable&&B(U)})}N(()=>{var B;return F(R,`${((B=l())==null?void 0:B.Name)??""} `)}),p(P,T)};A(te,P=>{i()&&(f().length>1||f().length>=1&&b.canBeExtracted[i()]||b.canBeMined[i()])?P(ge):P(Ie,!1)})}o(ee),o(Re);var Te=v(Re,2);{var De=P=>{var T=fr(),K=d(T);Gt(K,{get planner(){return r.planner}}),o(T),p(P,T)};A(Te,P=>{_()&&n()&&P(De)})}o(be);var He=v(be,2);{var Ce=P=>{var T=xr();ye(T,5,w,ke,(K,R)=>{var de=Ee();const J=y(()=>{var B,S,re;return(((B=E())==null?void 0:B[e(R)])??0)+(((S=Z())==null?void 0:S[e(R)])??0)-(((re=m())==null?void 0:re[e(R)])??0)}),he=y(()=>g()[e(R)]);var U=ie(de);et(U,()=>e(R),B=>{var S=Ee(),re=ie(S);{var Je=Me=>{pt(Me,{get planner(){return e(he)},deletecb:()=>r.planner.deleteChild(e(R))})},Xe=Me=>{var we=br(),qe=d(we);let lt;qe.__click=[hr,J,R,r];var ft=d(qe);{var ht=ve=>{var me=mr(),Ve=v(d(me),2);je(Ve,{get itemId(){return e(R)}});var Se=v(Ve,2),ze=d(Se,!0);o(Se),o(me),N(Ze=>{Qe(Se,`padding-left: ${(r.planner.depth+.5)*1.1}rem`),F(ze,Ze)},[()=>Math.round(e(J)*100)/100]),p(ve,me)},mt=(ve,me)=>{{var Ve=Se=>{var ze=gr(),Ze=v(d(ze),2);je(Ze,{get itemId(){return e(R)}});var rt=v(Ze,2),bt=d(rt,!0);o(rt),o(ze),N(xt=>{Qe(rt,`padding-left: ${(r.planner.depth+.5)*1.1}rem`),F(bt,xt)},[()=>Math.round(e(J)*100)/100]),p(Se,ze)};A(ve,Se=>{e(R)!==i()&&e(J)!==0&&Se(Ve)},me)}};A(ft,ve=>{var me;e(J)<0&&((me=b.producedVia[e(R)])==null?void 0:me.length)>0?ve(ht):ve(mt,!1)})}o(qe);var gt=v(qe,2);{var _t=ve=>{var me=_r();let Ve;var Se=d(me);Ct(Se,{get itemId(){return e(R)}}),o(me),N(ze=>Ve=Pe(me,1,"flex gap-2 items-center ",null,Ve,ze),[()=>({"text-green-500":e(J)>0,"text-red-500":e(J)<0})]),p(ve,me)};A(gt,ve=>{e(R)!==i()&&e(J)!==0&&ve(_t)})}o(we),N(ve=>lt=Pe(qe,1,"bg-slate-800  text-center rounded-r-lg",null,lt,ve),[()=>{var ve;return{"hover:bg-green-800":e(J)<0&&((ve=b.producedVia[e(R)])==null?void 0:ve.length)>0}}]),p(Me,we)};A(re,Me=>{e(he)?Me(Je):Me(Xe,!1)})}p(B,S)}),p(K,de)}),o(T),p(P,T)};A(He,P=>{var T;((T=w())==null?void 0:T.size)>0&&P(Ce)})}N(P=>X=Pe(k,1,"bg-slate-800  text-center rounded-r-lg  outline-slate-500",null,X,P),[()=>({"hover:bg-red-700":!r.planner.amountEditable,"outline-1":r.planner.amountEditable})]),p(u,oe),Oe(),a()}Ge(["click"]);var yr=x('<div class="flex flex-col items-stretch group w-full "><a class="my-2 z-30 hover:bg-slate-700 w-xs"> </a></div>'),kr=x('<div class="flex gap-0.5 flex-col mb-4 sticky top-0 mr-2 backdrop-blur-3xl backdrop-opacity-75  z-40"><!> <label for="recipeName">ingredient or recipe name</label><input id="recipeName"></div> <!>',1);function Br(u,r){Ae(r,!0);let t=Ne(st([])),a=at(),s=at(),n=at(),l=Ne(""),i=y(()=>e(l)?b.items.filter(m=>m.Name.toLowerCase().includes(e(l).toLowerCase())).map(m=>m.ID):[]),f=y(()=>(()=>{const m=new Set;return e(i).forEach(g=>{for(const I of b.relatedRecipes[g]??[])m.add(I)}),m})()),h=y(()=>b.recipees.filter(m=>e(t).length>0?e(t).includes(m.Type):!0).filter(m=>e(l)?e(f).has(m.ID):!0).filter(m=>a.checked===null?!0:a.checked?b.buildableRecipees.has(m.ID):!b.buildableRecipees.has(m.ID)).filter(m=>s.checked===null?!0:s.checked?b.fluidRecipees.has(m.ID):!b.fluidRecipees.has(m.ID)).filter(m=>n.checked===null?!0:n.checked?b.entityRecipees.has(m.ID):!b.entityRecipees.has(m.ID)));new Set(b.recipees.map(m=>m.Type));var _=kr(),c=ie(_),w=d(c);A(w,m=>{});var E=v(w,3);ut(E),o(c);var Z=v(c,2);ye(Z,17,()=>e(h),ke,(m,g)=>{var I=yr(),O=d(I),M=d(O,!0);o(O),o(I),N($=>{Ue(O,"href",$),F(M,e(g).Name)},[()=>nt.recipe(e(g).ID)]),p(m,I)}),vt(E,()=>e(l),m=>ce(l,m)),p(u,_),Oe()}Ge(["click"]);var wr=(u,r)=>ce(r,!e(r)),$r=(u,r,t,a)=>r(e(t),e(a)),Pr=x("<button><!> <span> </span></button>"),Rr=x('<div><h4 class="bg-blue-900 py-2 px-4 rounded-t"> </h4> <div class="flex bg-gray-600 "></div></div>'),Tr=x("<div></div> <!>",1),qr=x(`<button class="bg-blue-800 hover:bg-blue-700 hover:shadow-2xl  rounded-t py-5 px-4 flex">default tier for
	new factories <span class="ml-auto shadow-2xl"><!></span></button> <!>`,1);function Sr(u,r){Ae(r,!0);const[t,a]=Ke(),s=()=>q(n,"$defaultTierReadable",t);let n=_e.defaultTier;s();let l=Ne(!1);const i=(g,I)=>{const O={...s(),[g]:I};localStorage.setItem("defaultTiers",JSON.stringify(O)),_e.defaultTier.set(O)};var f=qr(),h=ie(f);h.__click=[wr,l];var _=v(d(h)),c=d(_);{var w=g=>{var I=We("🔼");p(g,I)},E=g=>{var I=We("🔽");p(g,I)};A(c,g=>{e(l)?g(w):g(E,!1)})}o(_),o(h);var Z=v(h,2);{var m=g=>{var I=Tr(),O=v(ie(I),2);ye(O,1,()=>Object.keys(s()),ke,(M,$)=>{var j=Ee(),D=ie(j);{var le=L=>{var G=Rr(),ae=d(G),pe=d(ae,!0);o(ae);var V=v(ae,2);ye(V,21,()=>_e.availableTiers[e($)],ke,(Q,W)=>{var ne=Pr();const se=y(()=>_e.factoryItems[e($)][e(W)]),C=y(()=>e(W)===s()[e($)]);let oe;ne.__click=[$r,i,$,W];var fe=d(ne);je(fe,{get itemId(){return e(se)}});var Be=v(fe,2),be=d(Be,!0);o(Be),o(ne),N(k=>{oe=Pe(ne,1,"flex-grow shadow-xl py-2 m-4 flex items-center justify-center gap-2      rounded-lg",null,oe,k),F(be,e(W))},[()=>({"outline-amber-100":e(C),"outline-1":e(C),active:e(C),"bg-slate-500":e(C),"hover:bg-slate-400":e(C),"text-white":e(C),"hover:bg-slate-700":!e(C),"text-gray-300":!e(C),"bg-slate-800":!e(C)})]),p(Q,ne)}),o(V),o(G),N(()=>F(pe,e($))),p(L,G)};A(D,L=>{var G;((G=_e.availableTiers[e($)])==null?void 0:G.length)>1&&L(le)})}p(M,j)}),p(g,I)};A(Z,g=>{e(l)&&g(m)})}p(u,f),Oe(),a()}Ge(["click"]);var Er=(u,r)=>ce(r,"bulidings"),Nr=(u,r)=>ce(r,"throughput"),Ar=x('<div class="text-right justify-self-end relative w-16"><div class="absolute right-0 top-0 z-0"><!></div> <span class="w-full h-full text-right top-0 backdrop-brightness-75 z-40"> </span></div>'),Or=x('<div class="flex gap-1 relative"><span class="absolute w-full text-center top-0 backdrop-brightness-85"> </span> <!></div>'),Cr=x('<div class="odd:bg-gray-950 gap-3 px-2 flex "><div class="justify-self-center w-14 text-center relative p-0.5"><em class="absolute w-full h-full text-right left-0 top-0 backdrop-brightness-85 "> </em> <!></div> <span class="flex-grow"> </span> <!></div>'),Mr=x('<div class="md:max-w-sm w-full flex flex-col mx-auto lg:ml-0 gap-0.5"><h4 class="px-4 py-2 bg-slate-800 rounded-t-lg flex items-center"><span class="flex-grow">required</span> <button>buildings</button> <button>conveyors</button></h4> <!></div>');function jr(u,r){Ae(r,!0);const[t,a]=Ke(),s=()=>q(f,"$itemId",t),n=()=>q(i,"$requiredBuildingsByRecipeId",t),l=()=>q(h,"$defaultTier",t);let{requiredBuildingsByRecipeId:i,itemId:f}=r.planner,{defaultTier:h}=_e;const _=M=>{switch(!0){case M<=6:return[[2001,1]];case M<=12:return[[2002,1]];case M<=30:return[[2003,1]];default:const $=Math.ceil(Math.ceil(M)/30),j=Math.ceil($/4);return[[2014,$%4],[2003,j]]}};let c=Ne("bulidings");var w=Mr(),E=d(w),Z=v(d(E),2);let m;Z.__click=[Er,c];var g=v(Z,2);let I;g.__click=[Nr,c],o(E);var O=v(E,2);et(O,s,M=>{var $=Ee(),j=ie($);ye(j,1,()=>Object.entries(n()),ke,(D,le)=>{var L=Ee();const G=y(()=>{const[V,Q]=e(le);return{recipeId:V,requiredBuildings:Q}});var ae=ie(L);{var pe=V=>{var Q=Cr();const W=y(()=>b.recipe[Number(e(G).recipeId)]),ne=y(()=>l()[e(W).Type]/e(W).TimeSpend),se=y(()=>e(W).ResultCounts.reduce((ee,te)=>te+ee,0)),C=y(()=>e(G).requiredBuildings*e(ne)*e(se)*60);var oe=d(Q),fe=d(oe),Be=d(fe);o(fe);var be=v(fe,2);const k=y(()=>{var ee,te;return(te=(ee=e(W))==null?void 0:ee.Results)==null?void 0:te[0]});je(be,{get itemId(){return e(k)}}),o(oe);var X=v(oe,2),Y=d(X,!0);o(X);var ue=v(X,2);{var xe=ee=>{var te=Ar();const ge=y(()=>String(Math.round(e(G).requiredBuildings*10)/10)),Ie=y(()=>e(ge).indexOf(".")),Te=y(()=>e(Ie)===-1?1:0);var De=d(te),He=d(De);je(He,{get itemId(){var T;return _e.factoryItems[(T=e(W))==null?void 0:T.Type][l()[e(W).Type]]}}),o(De);var Ce=v(De,2),P=d(Ce,!0);o(Ce),o(te),N(()=>{Qe(te,`padding-right: ${e(Te)+.5}em`),F(P,e(ge))}),p(ee,te)},Re=(ee,te)=>{{var ge=Ie=>{var Te=Ee(),De=ie(Te);ye(De,17,()=>_(e(C)),ke,(He,Ce)=>{var P=Ee(),T=ie(P);{var K=R=>{var de=Or(),J=d(de),he=d(J,!0);o(J);var U=v(J,2);je(U,{get itemId(){return e(Ce)[0]}}),o(de),N(()=>F(he,e(Ce)[1])),p(R,de)};A(T,R=>{e(Ce)[1]>0&&R(K)})}p(He,P)}),p(Ie,Te)};A(ee,Ie=>{e(c)==="throughput"&&Ie(ge)},te)}};A(ue,ee=>{e(c)==="bulidings"?ee(xe):ee(Re,!1)})}o(Q),N(ee=>{var te;F(Be,`${ee??""}/s`),F(Y,((te=e(W))==null?void 0:te.Name)??"recipe"+e(G).recipeId)},[()=>Math.round(e(C)*100)/100]),p(V,Q)};A(ae,V=>{e(G).recipeId&&V(pe)})}p(D,L)}),p(M,$)}),o(w),N((M,$)=>{m=Pe(Z,1," px-4 py-2 rounded-l-lg  outline-gray-600",null,m,M),I=Pe(g,1,"hover:bg-slate-500 px-4 py-2  rounded-r-lg  outline-gray-600",null,I,$)},[()=>({"bg-blue-700":e(c)==="bulidings","bg-gray-700":e(c)!=="bulidings","hover:bg-blue-500":e(c)==="bulidings","hover:bg-gray-500":e(c)!=="bulidings"}),()=>({"bg-blue-700":e(c)==="throughput","bg-gray-700":e(c)!=="throughput","hover:bg-blue-500":e(c)==="throughput","hover:bg-gray-500":e(c)!=="throughput"})]),p(u,w),Oe(),a()}Ge(["click"]);var Dr=x('<link rel="icon">'),Vr=(u,r)=>ce(r,!1),zr=(u,r)=>ce(r,!1),Fr=(u,r)=>r(),Lr=(u,r)=>ce(r,!1),Jr=x('<button class="fixed overscroll-contain w-screen h-screen backdrop-blur-2xl bg-black opacity-70 top-0 left-0 z-40" aria-label="close"></button> <dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2 fixed outline-1 rounded-2xl outline-slate-600"><h6 class="flex items-center justify-between"><span>Factory Globals</span><button class="bg-slate-800 hover:bg-slate-700 w-12 py-2">✖️</button></h6> <!> <span class="flex-grow"></span> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to existing</button> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to future</button></dialog>',1),Ur=(u,r)=>e(r).setInterval(0),Gr=(u,r,t)=>e(r).setInterval(t),Kr=(u,r)=>e(r).setInterval(60),Hr=x("<button>Second</button>"),Xr=(u,r)=>ce(r,!0),Zr=x(`<!> <div class="flex gap-12 flex-wrap lg:flex-nowrap"><div class="lg:max-w-sm lg:block hidden max-h-screen  ml-auto overflow-y-auto"><!></div> <div class="max-w-2xl w-full lg:mx-0 mx-auto"><div class="flex  text-sm py-1"><span class="px-3 py-1 bg-slate-800 rounded-r-lg">Items per <span class="inline-flex"><button> </button> <button>Minute</button> <!></span></span> <span class="px-3 py-3 flex-grow text-right"></span> <button class="px-3 py-3 bg-slate-800 hover:bg-slate-700 rounded-l-lg">⚙️
				Required Fabs to Process
				Items</button></div> <!></div> <!></div>`,1);function ca(u,r){Ae(r,!0);const[t,a]=Ke(),s=()=>q(h,"$defaultTier",t),n=()=>q(e(Z),"$header",t),l=()=>q(e(E),"$timeSpendChanged",t),i=()=>q(e(c),"$targetInterval",t),f=()=>q(e(w),"$timeSpend",t);let{defaultTier:h}=_e,_=y(()=>new tt(r.data.recipeId,void 0,void 0,void 0,void 0,r.data.depth,r.data.targetAmount)),c=y(()=>e(_).targetInterval),w=y(()=>e(_).timeSpend),E=y(()=>e(_).timeSpendChanged),Z=y(()=>e(_).header);const m=60*60;let g=Ne(!1);const I=k=>{k||(k=e(_));const X=Le(k.recipe);if(X){const Y=X.Type,ue=s()[Y];k.tier.set(ue)}Le(k.children).forEach(Y=>I(Y)),ce(g,!1)};var O=Zr();Nt(k=>{var X=Dr();N(()=>{var Y,ue;Et.title=(Y=n())==null?void 0:Y[1],Ue(X,"href",(ue=n())==null?void 0:ue[0])}),p(k,X)});var M=ie(O);{var $=k=>{var X=Jr(),Y=ie(X);Y.__click=[Vr,g];var ue=v(Y,2),xe=d(ue),Re=v(d(xe));Re.__click=[zr,g],o(xe);var ee=v(xe,2);Sr(ee,{});var te=v(ee,4);te.__click=[Fr,I];var ge=v(te,2);ge.__click=[Lr,g],o(ue),p(k,X)};A(M,k=>{e(g)&&k($)})}var j=v(M,2),D=d(j),le=d(D);Br(le,{}),o(D);var L=v(D,2),G=d(L),ae=d(G),pe=v(d(ae)),V=d(pe);let Q;V.__click=[Ur,_];var W=d(V);o(V);var ne=v(V,2);let se;ne.__click=[Gr,_,m];var C=v(ne,2);{var oe=k=>{var X=Hr();let Y;X.__click=[Kr,_],N(ue=>Y=Pe(X,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Y,ue),[()=>({active:i()===60})]),p(k,X)};A(C,k=>{f()!==60&&k(oe)})}o(pe),o(ae);var fe=v(ae,4);fe.__click=[Xr,g],o(G);var Be=v(G,2);et(Be,()=>e(_),k=>{pt(k,{get planner(){return e(_)}})}),o(L);var be=v(L,2);et(be,()=>e(_),k=>{jr(k,{get planner(){return e(_)}})}),o(j),N((k,X,Y)=>{Q=Pe(V,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Q,k),F(W,`Cycle (${X??""}s)`),se=Pe(ne,1,"px-1.5 py-2 multi hover:bg-slate-700",null,se,Y)},[()=>({"animate-flash":l(),active:i()===f()}),()=>Math.round(f()/60*100)/100,()=>({active:i()===m})]),p(u,O),Oe(),a()}Ge(["click"]);export{ca as component,da as universal};
