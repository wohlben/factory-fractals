var It=Object.defineProperty;var yt=(v,r,t)=>r in v?It(v,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):v[r]=t;var J=(v,r,t)=>yt(v,typeof r!="symbol"?r+"":r,t);import{c as Pe,t as x,a as f,b as Ye}from"../chunks/BmHjAyxW.js";import{au as kt,aH as Bt,X as wt,z as $t,A as et,B as Pt,K as Rt,J as Tt,L as qt,U as St,p as Oe,f as ie,t as O,g as e,e as y,a as Ce,b as Ae,s as u,c as d,r as o,h as ce,M as ot,aI as Et}from"../chunks/B-82rzdC.js";import{d as Ke,s as U,a as Nt}from"../chunks/D897dbaB.js";import{i as C}from"../chunks/BfA0D6Yw.js";import{s as Ue,r as ut,b as dt,L as nt}from"../chunks/h91-G9kU.js";import{t as At,s as Te,c as vt,b as Ot,o as at}from"../chunks/C3CEGPiq.js";import{s as He,a as T}from"../chunks/D2GXNv7x.js";import{D as b,e as ye,i as ke,I as Ct}from"../chunks/gwZSL3j3.js";import{w as $e,d as H,g as Le}from"../chunks/DWHFLt1U.js";import{a as it}from"../chunks/BHjB3LKT.js";import{p as st}from"../chunks/Cg9itU8Q.js";function Ge(v,r,t){et&&Pt();var a=v,s=St,n,i=kt()?Bt:wt;$t(()=>{i(s,s=r())&&(n&&Rt(n),n=Tt(()=>t(a)))}),et&&(a=qt)}function We(v,r,t,a){var s=v.__style;if(et||s!==r){var n=At(r);(!et||n!==v.getAttribute("style"))&&(n==null?v.removeAttribute("style"):v.style.cssText=n),v.__style=r}return a}const Mt=!1,jt=({params:v,url:r})=>{const{id:t}=v,a=Number(t),s=r.searchParams.get("depth"),n=r.searchParams.get("targetAmount");return{recipeId:a,depth:s&&parseInt(s)||1,targetAmount:n&&parseInt(n)||1}},da=Object.freeze(Object.defineProperty({__proto__:null,load:jt,prerender:Mt},Symbol.toStringTag,{value:"Module"})),Dt=()=>{const v=localStorage==null?void 0:localStorage.getItem("defaultTiers");if(v){const r=JSON.parse(v);return $e(r)}},fe={defaultTier:Dt()??$e({Smelt:1,Assemble:.75,Research:1,Chemical:1,Refine:1,Particle:1,Fractionate:1,Proliferator:1}),availableTiers:{Smelt:[1,2,3],Assemble:[.75,1,1.5,3],Research:[1],Refine:[1],Chemical:[1,2],Particle:[1],Fractionate:[1],Proliferator:[.125,.2,.25]},factoryItems:{Smelt:{1:2302,2:2315,3:2319},Assemble:{.75:2303,1:2304,1.5:2305,3:2318},Research:{1:2901,2:2902},Chemical:{1:2309,2:2317},Refine:{1:2308},Particle:{1:2310},Fractionate:{1:2314},Proliferator:{.125:1141,.2:1142,.25:1143}}};class Vt{constructor(r,t,a,s,n,i,l){this.recipeId=r,this.itemId=t,this.targetAmount=a,this.targetInterval=s,this.tier=n,this.proliferator=i,this.timeSpend=l}}const Fe=(v,r)=>{const t={...v};return Object.entries(r).forEach(([a,s])=>{const n=Number(a);t[n]=(t[n]??0)+s}),t};class tt extends Vt{constructor(t,a,s,n,i=0,l=1,p){var F;const m=!!(a&&(b.canBeExtracted[a]||b.canBeMined[a]));!t&&!m&&(t=(F=b.alternativeRecipe[a])==null?void 0:F[0]);const _=$e(t),c=t?b.recipe[t]:void 0;let $=c==null?void 0:c.Results.findIndex(j=>a===j);const N=!a;!a&&($??-1)>=0&&(a=c==null?void 0:c.Results[$??0]);const Z=$e(a),g=$e((c==null?void 0:c.ResultCounts[$??0])??p??1),h=s?H([Z,s],([j,te])=>te[j]):g,I=$e(c!=null&&c.Type?Le(fe.defaultTier)[c.Type]:1),M=$e(Le(fe.defaultTier).Proliferator),z=$e(0),k=H([_,I],([j,te])=>{var q;return((q=b.recipe[j])==null?void 0:q.TimeSpend)/te});n||(n=H([z,k],([j,te])=>j>0?j:te));super(_,Z,h,n,I,M,k);J(this,"amountEditable");J(this,"manualAmount",$e());J(this,"manualInterval");J(this,"children",$e([]));J(this,"canBeMined",H(this.itemId,t=>b.canBeMined[t]));J(this,"canBeExtracted",H(this.itemId,t=>b.canBeExtracted[t]));J(this,"item",H(this.itemId,t=>b.item[t]));J(this,"recipe",H(this.recipeId,t=>b.recipe[t]));J(this,"header",H([this.itemId,this.recipe],([t,a])=>{var p;const s=t??((p=a==null?void 0:a.Results)==null?void 0:p[0]);if(!s)return;const n=b.item[s],i=n.IconPath.split("/"),l=i[i.length-1];return l&&[it+`/dsp_sprites/${l}.png`,n.Name]}));J(this,"options",H(this.itemId,t=>b.alternativeRecipe[t]));J(this,"timeSpendChanged",H(this.timeSpend,(t,a)=>{a(!!t);const s=setTimeout(()=>a(!t),1400);return()=>clearTimeout(s)}));J(this,"relativeSpeed",H([this.targetInterval,this.timeSpend],([t,a])=>t/a));J(this,"requiredBuildings",H([this.targetAmount,this.recipe,this.itemId,this.relativeSpeed,this.proliferator],([t,a,s,n,i])=>{const l=a==null?void 0:a.Results.findIndex(m=>s===m),p=t/(a==null?void 0:a.ResultCounts[l])/n;return isNaN(p)?t:p}));J(this,"providedItemsPerInterval",H([this.recipe,this.relativeSpeed,this.requiredBuildings,this.itemId,this.targetAmount],([t,a,s,n,i])=>{if(!t&&n&&(b.canBeMined[n]||b.canBeExtracted[n]))return{[n]:i};const l={};return t==null||t.Results.forEach((p,m)=>{l[p]=t.ResultCounts[m]*a*s}),l}));J(this,"childrenProvideItemsPerInterval",H(this.children,(t,a)=>{const s=new Array(t.length),n=t.map((l,p)=>l.providedItemsPerInterval.subscribe(m=>{s[p]=m;const _=s.filter(c=>!!c).reduce((c,$)=>Fe(c,$),{});a(_)})),i=s.filter(l=>!!l).reduce((l,p)=>Fe(l,p),{});return a(i),()=>n.forEach(l=>l())}));J(this,"requiredBuildingsByRecipeId",H([this.children,this.recipeId,this.requiredBuildings],([t,a,s],n)=>{const i=new Array(t.length),l=t.map((m,_)=>m.requiredBuildingsByRecipeId.subscribe(c=>{i[_]=c;const $=i.filter(N=>!!N).reduce((N,Z)=>Fe(N,Z),{});if(a){const N=a;$[N]=($[N]??0)+s}n($)})),p=i.filter(m=>!!m).reduce((m,_)=>Fe(m,_),{});if(a){const m=a;p[m]=(p[m]??0)+s}return n(p),()=>l.forEach(m=>m())}));J(this,"fabsByType",H(this.requiredBuildingsByRecipeId,t=>Object.entries(t).reduce((a,[s,n])=>{const i=Number(s),l=b.recipe[i].Type;return a[l]=(a[l]??0)+Math.ceil(n),a},{})));J(this,"childrenByItemId",H(this.children,(t,a)=>{const s=new Array(t.length),n=t.map((l,p)=>l.itemId.subscribe(m=>{s[p]=[m,l];const _=s.filter(c=>!!c).reduce((c,[$,N])=>(c[$]=N,c),{});a(_)})),i=s.filter(l=>!!l).reduce((l,[p,m])=>(l[p]=m,l),{});return a(i),()=>n.forEach(l=>l())}));J(this,"requiredItemsPerInterval",H([this.recipe,this.relativeSpeed,this.requiredBuildings],([t,a,s])=>{const n={};return t==null||t.Items.forEach((i,l)=>n[i]=t.ItemCounts[l]*a*s),n}));J(this,"deficitRequiredItemsPerInterval",H([this.recipe,this.relativeSpeed,this.requiredBuildings],([t,a,s])=>{const n={};return t==null||t.Items.forEach((i,l)=>n[i]=-(t.ItemCounts[l]*a*s)),n}));J(this,"inputsOutputs",H([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval],([t,a,s])=>{const n=new Set;return Object.keys(a).forEach(i=>{n.add(Number(i))}),Object.keys(t??{}).forEach(i=>{n.add(Number(i))}),Object.keys(s).forEach(i=>{n.add(Number(i))}),n}));J(this,"surplus",H([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval,this.itemId],([t,a,s,n])=>{const i=Fe(t,s);return Object.entries(a).forEach(([l,p])=>i[Number(l)]=(i[Number(l)]??0)-p),Object.entries(i).filter(([,l])=>l<=0).forEach(([l])=>delete i[Number(l)]),i}));J(this,"deficit",H([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval],([t,a])=>{const s={...t};return Object.entries(a).forEach(([n,i])=>s[Number(n)]=(s[Number(n)]??0)-i),Object.entries(s).filter(([,n])=>n>=0).forEach(([n])=>delete s[Number(n)]),s}));J(this,"deficitByItemId",H([this.children,this.deficit,this.recipeId,this.itemId,this.targetAmount],([t,a,s,n,i],l)=>{const p=new Array(t.length),m=t.map((c,$)=>c.deficitByItemId.subscribe(N=>{p[$]=N;const Z=p.filter(g=>!!g).reduce((g,h)=>Fe(g,h),s?a:{[n]:-i});l(Z)})),_=p.filter(c=>!!c).reduce((c,$)=>Fe(c,$),s?a:{[n]:-i});return l(_),()=>m.forEach(c=>c())}));J(this,"totals",H([this.itemId,this.requiredBuildings,this.children],([t,a,s])=>{const n={};return n[t]=a,s.map(i=>i.totals).forEach(i=>{Object.entries(i).forEach(([l,p])=>{const m=Number(l);n[m]=(n[m]??0)+p})}),n}));this.depth=i,this.amountEditable=N,this.manualAmount=g,this.manualInterval=z,l>i&&this.children.set(this.dbd(l))}setAmount(t){this.manualAmount.set(t)}setRecipeId(t){this.recipeId.set(t),this.expand()}deleteChild(t){this.children.update(a=>{const s=a.findIndex(n=>Le(n.itemId)===t);return a.splice(s,1),a})}setInterval(t){this.manualInterval.set(t)}expand(){this.children.set(this.dbd())}planFor(t){this.children.update(a=>(a.push(new tt(void 0,t,this.requiredItemsPerInterval,this.targetInterval,this.depth+1)),a))}dbd(t){const a=[],s=Le(this.recipe);return s==null||s.Items.forEach((n,i)=>{var m;if(!((m=b.alternativeRecipe[n])!=null&&m.length))return;const l=new tt(void 0,n,this.requiredItemsPerInterval,this.targetInterval,this.depth+1,t);a.push(l);const p=Le(l.providedItemsPerInterval);Object.entries(p).forEach(([_,c])=>{})}),a}}var zt=x('<img class="h-6" alt="">');function Re(v,r){Oe(r,!0);let t=y(()=>b.item[r.itemId]);const a=y(()=>{var p;return(p=e(t))==null?void 0:p.IconPath.split("/")}),s=y(()=>e(a)&&e(a)[e(a).length-1]),n=y(()=>e(s)&&it+`/dsp_sprites/${e(s)}.png`);var i=Pe(),l=ie(i);Ge(l,()=>r.itemId,p=>{var m=zt();O(()=>Ue(m,"src",e(n))),f(p,m)}),f(v,i),Ce()}var Ft=(v,r,t)=>r(e(t)),Lt=x("<button> <!></button>"),Jt=x('<div><span class="text-xs text-gray-400">Tier</span> <!></div>'),Ut=(v,r)=>ce(r,!0),Gt=x('<button class="text-center min-w-16 h-10 rounded-l-lg bg-slate-800 hover:bg-slate-600 py-2 px-3 flex justify-around items-end gap-2 relative "><span class="top-0 absolute left-0 scale-75 opacity-50"><!></span> <span class="text-xs text-gray-400 absolute top-0"> </span> <b class="bottom-0.5 absolute"> </b></button>');function Kt(v,r){Oe(r,!0);const[t,a]=He(),s=()=>T(l,"$recipe",t),n=()=>T(p,"$tier",t),i=()=>T(m,"$requiredBuildings",t);let{recipe:l,tier:p,requiredBuildings:m}=r.planner,_=Ae(!1);const c=h=>{r.planner.tier.set(h),ce(_,!1)};var $=Pe(),N=ie($);{var Z=h=>{var I=Jt(),M=u(d(I),2);ye(M,1,()=>fe.availableTiers[s().Type],ke,(z,k)=>{var F=Lt();let j;F.__click=[Ft,c,k];var te=d(F),q=u(te);Re(q,{get itemId(){var A;return fe.factoryItems[(A=s())==null?void 0:A.Type][e(k)]}}),o(F),O(A=>{j=Te(F,1,"px-2 py-1 outline-slate-600 hover:bg-slate-600 text-sm  rounded",null,j,A),U(te,`${e(k)??""} `)},[()=>({"outline-1":e(k)===n(),active:e(k)===n()})]),f(z,F)}),o(I),f(h,I)},g=h=>{var I=Gt();I.__click=[Ut,_];var M=d(I),z=d(M);Re(z,{get itemId(){var q;return fe.factoryItems[(q=s())==null?void 0:q.Type][n()]}}),o(M);var k=u(M,2),F=d(k);o(k);var j=u(k,2),te=d(j,!0);o(j),o(I),O(q=>{U(F,`tier ${n()??""}`),U(te,q)},[()=>Math.round(i()*100)/100]),f(h,I)};C(N,h=>{e(_)?h(Z):h(g,!1)})}f(v,$),Ce(),a()}Ke(["click"]);var Ht=x('<div class="flex gap-4 hover:bg-gray-700"><span> </span> <span class="text-right flex-grow"> </span></div>'),Xt=x('<div class="flex odd:bg-gray-950 gap-2 px-2 items-center hover:bg-gray-700 "><span class="w-14 text-right"> </span> <span class="text-slate-300 text-xs">x</span> <span> </span> <span class="text-slate-400 text-xs"> </span> <em class="text-right flex-grow"> </em></div>'),Zt=x('<div class="flex gap-4 hover:bg-gray-700 px-1"><span> </span></div>'),Qt=x('<div><h3 class="bg-blue-800 py-2 px-4  text-center "><span class="w-14 text-right"> </span> <span class="text-xs text-slate-400">x</span> </h3> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Buildings</h5> <div class="mb-4 my-4 mx-auto  grid grid-cols-2 gap-x-8 justify-center px-0.5"></div> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">Recipes</h5> <!> <h5 class="bg-blue-900 text-center py-1 px-4 mt-4 mb-2">ingress</h5> <div class="mx-auto  grid grid-cols-2 gap-x-8 justify-center px-0.5"></div></div>');function Wt(v,r){Oe(r,!0);const[t,a]=He(),s=()=>T(N,"$requiredBuildings",t),n=()=>T($,"$recipe",t),i=()=>T(c,"$fabsByType",t),l=()=>T(_,"$requiredBuildingsByRecipeId",t),p=()=>T(g,"$defaultTier",t),m=()=>T(Z,"$deficitByItemId",t);let{requiredBuildingsByRecipeId:_,fabsByType:c,recipe:$,requiredBuildings:N,deficitByItemId:Z}=r.planner,{defaultTier:g}=fe;var h=Qt(),I=d(h),M=d(I),z=d(M,!0);o(M);var k=u(M,3);o(I);var F=u(I,4);ye(F,5,()=>Object.entries(i()),ke,(q,A)=>{var ne=Ht();const pe=y(()=>{const[le,D]=e(A);return{fabType:le,requiredFabs:D}});var L=d(ne),Q=d(L,!0);o(L);var W=u(L,2),se=d(W,!0);o(W),o(ne),O(()=>{U(Q,e(pe).fabType),U(se,e(pe).requiredFabs)}),f(q,ne)}),o(F);var j=u(F,4);ye(j,1,()=>Object.entries(l()??{}),ke,(q,A,ne,pe)=>{var L=Pe();const Q=y(()=>{const[le,D]=e(A);return{recipeId:le,requiredBuildings:D}});var W=ie(L);{var se=le=>{var D=Xt();const oe=y(()=>b.recipe[Number(e(Q).recipeId)]),me=y(()=>p()[e(oe).Type]/e(oe).TimeSpend),Be=y(()=>e(oe).ResultCounts.reduce((_e,Ie)=>Ie+_e,0)),be=y(()=>e(Q).requiredBuildings*e(me)*e(Be)*60);var B=d(D),X=d(B,!0);o(B);var Y=u(B,4),ue=d(Y,!0);o(Y);var xe=u(Y,2),qe=d(xe);o(xe);var ee=u(xe,2),re=d(ee);o(ee),o(D),O((_e,Ie)=>{var Se;U(X,_e),U(ue,((Se=e(oe))==null?void 0:Se.Name)??"recipe"+e(Q).recipeId),U(qe,`tier ${p()[e(oe).Type]??""}`),U(re,`${Ie??""}/s`)},[()=>Math.round(e(Q).requiredBuildings*100)/100,()=>Math.round(e(be)*100)/100]),f(le,D)};C(W,le=>{e(Q).recipeId&&le(se)})}f(q,L)});var te=u(j,4);ye(te,5,()=>Object.entries(m()),ke,(q,A)=>{var ne=Zt();const pe=y(()=>{const[W]=e(A);return{itemId:W}});var L=d(ne),Q=d(L,!0);o(L),o(ne),O(()=>U(Q,b.item[e(pe).itemId].Name)),f(q,ne)}),o(te),o(h),O(q=>{U(z,q),U(k,` ${n().Name??""}`)},[()=>Math.round(s()*100)/100]),f(v,h),Ce(),a()}var Yt=x('<img class="h-6" alt="">');function ct(v,r){Oe(r,!0);const t=y(()=>r.filename.split("/")),a=y(()=>e(t)&&e(t)[e(t).length-1]),s=y(()=>e(a)&&it+`/dsp_sprites/${e(a)}.png`);var n=Yt();O(()=>Ue(n,"src",e(s))),f(v,n),Ce()}var er=(v,r)=>ce(r,!1),tr=(v,r)=>ce(r,!1),rr=x('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2 fixed "><!> <button class="bg-green-800 hover:bg-green-700 py-2 rounded-xl mt-auto">close</button></dialog> <button class="fixed overscroll-contain w-screen h-screen backdrop-blur-2xl bg-black opacity-70 top-0 left-0 z-40" aria-label="close"></button>',1),ar=(v,r)=>{var t;return(t=r.deletecb)==null?void 0:t.call(r)},nr=x(`<style scoped="">input::-webkit-outer-spin-button,
          input::-webkit-inner-spin-button {
              /* display: none; <- Crashes Chrome on hover */
              -webkit-appearance: none;
              margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
          }

          input[type=number] {
              -moz-appearance: textfield;
          }</style> <label class="flex items-center pl-2 gap-1"><!> <input type="number" class="text-left rounded-r-lg w-16 outline-none"></label>`,1),sr=x('<div class="flex items-center"><span class="pl-2">ğŸ—‘ï¸</span>ï¸ <!> <span class="text-sm py-2 block pr-4"> </span></div>'),ir=x("<option><!> </option>"),lr=x("<option> </option>"),or=x('<a class="bg-gray-800 hover:bg-slate-700">â¡ï¸</a>'),dr=x('<select class="my-1 truncate contain-content"><!><!></select> <!>',1),cr=x('<a class="bg-gray-800 hover:bg-slate-700">â¡ï¸</a>'),ur=(v,r)=>ce(r,!0),vr=x('<button class="py-1 rounded-xl px-4 bg-slate-800 hover:bg-slate-700">ğŸ”</button>'),pr=x('<span class="flex-grow"> <!></span> <!>',1),fr=x('<div class="ml-auto"><!></div>'),mr=(v,r,t,a)=>{var s;return e(r)<0&&((s=b.producedVia[e(t)])==null?void 0:s.length)>0&&a.planner.planFor(e(t))},gr=x('<div class="flex items-center"><span class="pl-2">ğŸ“</span>ï¸ <!> <span class="text-sm py-2 block pr-4"> </span></div>'),hr=x('<div class="flex items-center"><span class="px-3.5"></span>ï¸ <!> <span class="text-sm py-2 block pr-4"> </span></div>'),_r=x("<div><!></div>"),br=x('<div class="flex gap-2 hover:bg-gray-700"><button><!></button> <!></div>'),xr=x('<div class="flex flex-col gap-0.5 "></div>'),Ir=x('<!> <div class="flex gap-1 max-w-2xl items-center hover:bg-gray-700  flex-wrap @container"><button><!></button> <div class="flex-grow px-4 "><div class="flex items-center gap-4"><!></div></div> <!></div> <!>',1);function pt(v,r){Oe(r,!0);const[t,a]=He(),s=()=>T(q,"$targetAmount",t),n=()=>T(k,"$recipeId",t),i=()=>T(z,"$recipe",t),l=()=>T(M,"$itemId",t),p=()=>T(Q,"$options",t),m=()=>T(I,"$item",t),_=()=>T(F,"$requiredBuildings",t),c=()=>T(j,"$children",t),$=()=>T(L,"$inputsOutputs",t),N=()=>T(ne,"$providedItemsPerInterval",t),Z=()=>T(A,"$childrenProvideItemsPerInterval",t),g=()=>T(pe,"$requiredItemsPerInterval",t),h=()=>T(te,"$childrenByItemId",t);let{item:I,itemId:M,recipe:z,recipeId:k,requiredBuildings:F,children:j,childrenByItemId:te,targetAmount:q,childrenProvideItemsPerInterval:A,providedItemsPerInterval:ne,requiredItemsPerInterval:pe,inputsOutputs:L,options:Q,header:W}=r.planner,se=Ae(st(s())),le=Ae(st(n())),D=Ae(!1);ot(()=>{r.planner.amountEditable&&s()!==e(se)&&r.planner.setAmount(e(se))}),ot(()=>{e(le)!==n()&&r.planner.setRecipeId(e(le))});var oe=Ir(),me=ie(oe);{var Be=P=>{var S=rr(),V=ie(S),R=d(V);Wt(R,{get planner(){return r.planner}});var de=u(R,2);de.__click=[er,D],o(V);var G=u(V,2);G.__click=[tr,D],f(P,S)};C(me,P=>{e(D)&&P(Be)})}var be=u(me,2),B=d(be);B.__click=[ar,r];let X;var Y=d(B);{var ue=P=>{var S=nr(),V=u(ie(S),2),R=d(V);{var de=K=>{ct(K,{get filename(){return i().IconPath}})},G=K=>{const w=y(()=>{var E,ae;return(ae=(E=i())==null?void 0:E.Results)==null?void 0:ae[0]});Re(K,{get itemId(){return e(w)}})};C(R,K=>{var w;(w=i())!=null&&w.IconPath?K(de):K(G,!1)})}var ge=u(R,2);ut(ge),o(V),vt(ge,()=>e(se),K=>ce(se,K)),f(P,S)},xe=P=>{var S=sr(),V=u(d(S),2);{var R=K=>{ct(K,{get filename(){return i().IconPath}})},de=K=>{Re(K,{get itemId(){return l()}})};C(V,K=>{var w;(w=i())!=null&&w.IconPath?K(R):K(de,!1)})}var G=u(V,2),ge=d(G,!0);o(G),o(S),O(K=>{We(G,`padding-left: ${r.planner.depth*1.1}rem`),U(ge,K)},[()=>Math.round(s()*100)/100]),f(P,S)};C(Y,P=>{r.planner.amountEditable?P(ue):P(xe,!1)})}o(B);var qe=u(B,2),ee=d(qe),re=d(ee);{var _e=P=>{var S=dr(),V=ie(S),R=d(V);{var de=w=>{var E=ir();E.value=(E.__value=void 0)==null?"":void 0;var ae=d(E);{var Je=we=>{var Ee=Ye("orbital collector");f(we,Ee)},Ze=we=>{var Ee=Ye("mining");f(we,Ee)};C(ae,we=>{b.canBeExtracted[l()]?we(Je):we(Ze,!1)})}var je=u(ae);o(E),O(()=>{dt(E,n()===void 0),U(je,` (${m().Name??""})`)}),f(w,E)};C(R,w=>{(b.canBeExtracted[l()]||b.canBeMined[l()])&&w(de)})}var G=u(R);ye(G,1,p,ke,(w,E)=>{var ae=lr(),Je={},Ze=d(ae,!0);o(ae),O(()=>{Je!==(Je=b.recipe[e(E)].ID)&&(ae.value=(ae.__value=b.recipe[e(E)].ID)==null?"":b.recipe[e(E)].ID),dt(ae,n()===b.recipe[e(E)].ID),U(Ze,b.recipe[e(E)].Name)}),f(w,ae)}),o(V);var ge=u(V,2);{var K=w=>{var E=or();O(ae=>Ue(E,"href",ae),[()=>nt.recipe(i().ID)+"?targetAmount="+Math.round(_())+"&depth=10"]),f(w,E)};C(ge,w=>{!r.planner.amountEditable&&i()&&w(K)})}Ot(V,()=>e(le),w=>ce(le,w)),f(P,S)},Ie=P=>{var S=pr(),V=ie(S),R=d(V),de=u(R);{var G=w=>{var E=cr();O(ae=>Ue(E,"href",ae),[()=>nt.recipe(i().ID)+"?targetAmount="+Math.round(_())+"&depth=10"]),f(w,E)};C(de,w=>{r.planner.amountEditable||w(G)})}o(V);var ge=u(V,2);{var K=w=>{var E=vr();E.__click=[ur,D],f(w,E)};C(ge,w=>{c().length>1&&!r.planner.amountEditable&&w(K)})}O(()=>{var w;return U(R,`${((w=i())==null?void 0:w.Name)??""} `)}),f(P,S)};C(re,P=>{l()&&(p().length>1||p().length>=1&&b.canBeExtracted[l()]||b.canBeMined[l()])?P(_e):P(Ie,!1)})}o(ee),o(qe);var Se=u(qe,2);{var De=P=>{var S=fr(),V=d(S);Kt(V,{get planner(){return r.planner}}),o(S),f(P,S)};C(Se,P=>{_()&&n()&&P(De)})}o(be);var Xe=u(be,2);{var Me=P=>{var S=xr();ye(S,5,$,ke,(V,R)=>{var de=Pe();const G=y(()=>{var w,E,ae;return(((w=N())==null?void 0:w[e(R)])??0)+(((E=Z())==null?void 0:E[e(R)])??0)-(((ae=g())==null?void 0:ae[e(R)])??0)}),ge=y(()=>h()[e(R)]);var K=ie(de);Ge(K,()=>e(R),w=>{var E=Pe(),ae=ie(E);{var Je=je=>{pt(je,{get planner(){return e(ge)},deletecb:()=>r.planner.deleteChild(e(R))})},Ze=je=>{var we=br(),Ee=d(we);let lt;Ee.__click=[mr,G,R,r];var ft=d(Ee);{var mt=ve=>{var he=gr(),Ve=u(d(he),2);Re(Ve,{get itemId(){return e(R)}});var Ne=u(Ve,2),ze=d(Ne,!0);o(Ne),o(he),O(Qe=>{We(Ne,`padding-left: ${(r.planner.depth+.5)*1.1}rem`),U(ze,Qe)},[()=>Math.round(e(G)*100)/100]),f(ve,he)},gt=(ve,he)=>{{var Ve=Ne=>{var ze=hr(),Qe=u(d(ze),2);Re(Qe,{get itemId(){return e(R)}});var rt=u(Qe,2),bt=d(rt,!0);o(rt),o(ze),O(xt=>{We(rt,`padding-left: ${(r.planner.depth+.5)*1.1}rem`),U(bt,xt)},[()=>Math.round(e(G)*100)/100]),f(Ne,ze)};C(ve,Ne=>{e(R)!==l()&&e(G)!==0&&Ne(Ve)},he)}};C(ft,ve=>{var he;e(G)<0&&((he=b.producedVia[e(R)])==null?void 0:he.length)>0?ve(mt):ve(gt,!1)})}o(Ee);var ht=u(Ee,2);{var _t=ve=>{var he=_r();let Ve;var Ne=d(he);Ct(Ne,{get itemId(){return e(R)}}),o(he),O(ze=>Ve=Te(he,1,"flex gap-2 items-center ",null,Ve,ze),[()=>({"text-green-500":e(G)>0,"text-red-500":e(G)<0})]),f(ve,he)};C(ht,ve=>{e(R)!==l()&&e(G)!==0&&ve(_t)})}o(we),O(ve=>lt=Te(Ee,1,"bg-slate-800  text-center rounded-r-lg",null,lt,ve),[()=>{var ve;return{"hover:bg-green-800":e(G)<0&&((ve=b.producedVia[e(R)])==null?void 0:ve.length)>0}}]),f(je,we)};C(ae,je=>{e(ge)?je(Je):je(Ze,!1)})}f(w,E)}),f(V,de)}),o(S),f(P,S)};C(Xe,P=>{var S;((S=$())==null?void 0:S.size)>0&&P(Me)})}O(P=>X=Te(B,1,"bg-slate-800  text-center rounded-r-lg  outline-slate-500",null,X,P),[()=>({"hover:bg-red-700":!r.planner.amountEditable,"outline-1":r.planner.amountEditable})]),f(v,oe),Ce(),a()}Ke(["click"]);var yr=x('<div class="flex flex-col items-stretch group w-full "><a class="my-2 z-30 hover:bg-slate-700 w-xs"> </a></div>'),kr=x('<div class="flex gap-0.5 flex-col mb-4 sticky top-0 mr-2 backdrop-blur-3xl backdrop-opacity-75  z-40"><!> <label for="recipeName">ingredient or recipe name</label><input id="recipeName"></div> <!>',1);function Br(v,r){Oe(r,!0);let t=Ae(st([])),a=at(),s=at(),n=at(),i=Ae(""),l=y(()=>e(i)?b.items.filter(g=>g.Name.toLowerCase().includes(e(i).toLowerCase())).map(g=>g.ID):[]),p=y(()=>(()=>{const g=new Set;return e(l).forEach(h=>{for(const I of b.relatedRecipes[h]??[])g.add(I)}),g})()),m=y(()=>b.recipees.filter(g=>e(t).length>0?e(t).includes(g.Type):!0).filter(g=>e(i)?e(p).has(g.ID):!0).filter(g=>a.checked===null?!0:a.checked?b.buildableRecipees.has(g.ID):!b.buildableRecipees.has(g.ID)).filter(g=>s.checked===null?!0:s.checked?b.fluidRecipees.has(g.ID):!b.fluidRecipees.has(g.ID)).filter(g=>n.checked===null?!0:n.checked?b.entityRecipees.has(g.ID):!b.entityRecipees.has(g.ID)));new Set(b.recipees.map(g=>g.Type));var _=kr(),c=ie(_),$=d(c);C($,g=>{});var N=u($,3);ut(N),o(c);var Z=u(c,2);ye(Z,17,()=>e(m),ke,(g,h)=>{var I=yr(),M=d(I),z=d(M,!0);o(M),o(I),O(k=>{Ue(M,"href",k),U(z,e(h).Name)},[()=>nt.recipe(e(h).ID)]),f(g,I)}),vt(N,()=>e(i),g=>ce(i,g)),f(v,_),Ce()}Ke(["click"]);var wr=(v,r)=>ce(r,!e(r)),$r=(v,r,t,a)=>r(e(t),e(a)),Pr=x("<button><!> <span> </span></button>"),Rr=x('<div><h4 class="bg-blue-900 py-2 px-4 rounded-t"> </h4> <div class="flex bg-gray-600 "></div></div>'),Tr=x("<div></div> <!>",1),qr=x(`<button class="bg-blue-800 hover:bg-blue-700 hover:shadow-2xl  rounded-t py-5 px-4 flex">default tier for
	new factories <span class="ml-auto shadow-2xl"><!></span></button> <!>`,1);function Sr(v,r){Oe(r,!0);const[t,a]=He(),s=()=>T(n,"$defaultTierReadable",t);let n=fe.defaultTier;s();let i=Ae(!1);const l=(h,I)=>{const M={...s(),[h]:I};localStorage.setItem("defaultTiers",JSON.stringify(M)),fe.defaultTier.set(M)};var p=qr(),m=ie(p);m.__click=[wr,i];var _=u(d(m)),c=d(_);{var $=h=>{var I=Ye("ğŸ”¼");f(h,I)},N=h=>{var I=Ye("ğŸ”½");f(h,I)};C(c,h=>{e(i)?h($):h(N,!1)})}o(_),o(m);var Z=u(m,2);{var g=h=>{var I=Tr(),M=u(ie(I),2);ye(M,1,()=>Object.keys(s()),ke,(z,k)=>{var F=Pe(),j=ie(F);{var te=q=>{var A=Rr(),ne=d(A),pe=d(ne,!0);o(ne);var L=u(ne,2);ye(L,21,()=>fe.availableTiers[e(k)],ke,(Q,W)=>{var se=Pr();const le=y(()=>fe.factoryItems[e(k)][e(W)]),D=y(()=>e(W)===s()[e(k)]);let oe;se.__click=[$r,l,k,W];var me=d(se);Re(me,{get itemId(){return e(le)}});var Be=u(me,2),be=d(Be,!0);o(Be),o(se),O(B=>{oe=Te(se,1,"flex-grow shadow-xl py-2 m-4 flex items-center justify-center gap-2      rounded-lg",null,oe,B),U(be,e(W))},[()=>({"outline-amber-100":e(D),"outline-1":e(D),active:e(D),"bg-slate-500":e(D),"hover:bg-slate-400":e(D),"text-white":e(D),"hover:bg-slate-700":!e(D),"text-gray-300":!e(D),"bg-slate-800":!e(D)})]),f(Q,se)}),o(L),o(A),O(()=>U(pe,e(k))),f(q,A)};C(j,q=>{var A;((A=fe.availableTiers[e(k)])==null?void 0:A.length)>1&&q(te)})}f(z,F)}),f(h,I)};C(Z,h=>{e(i)&&h(g)})}f(v,p),Ce(),a()}Ke(["click"]);var Er=(v,r)=>ce(r,"bulidings"),Nr=(v,r)=>ce(r,"throughput"),Ar=x('<div class="text-right justify-self-end relative w-16"><div class="absolute right-0 top-0 z-0"><!></div> <span class="w-full h-full text-right top-0 backdrop-brightness-75 z-40"> </span></div>'),Or=x('<div class="flex gap-1 relative"><span class="absolute w-full text-center top-0 backdrop-brightness-85"> </span> <!></div>'),Cr=x('<div class="odd:bg-gray-950 gap-3 px-2 flex "><div class="justify-self-center w-14 text-center relative p-0.5"><em class="absolute w-full h-full text-right left-0 top-0 backdrop-brightness-85 "> </em> <!></div> <span class="flex-grow"> </span> <!></div>'),Mr=x('<div class="md:max-w-sm w-full flex flex-col mx-auto lg:ml-0 gap-0.5"><h4 class="px-4 py-2 bg-slate-800 rounded-t-lg flex items-center"><span class="flex-grow">required</span> <button>buildings</button> <button>conveyors</button></h4> <!></div>');function jr(v,r){Oe(r,!0);const[t,a]=He(),s=()=>T(p,"$itemId",t),n=()=>T(l,"$requiredBuildingsByRecipeId",t),i=()=>T(m,"$defaultTier",t);let{requiredBuildingsByRecipeId:l,itemId:p}=r.planner,{defaultTier:m}=fe;const _=z=>{switch(!0){case z<=6:return[[2001,1]];case z<=12:return[[2002,1]];case z<=30:return[[2003,1]];default:const k=Math.ceil(Math.ceil(z)/30),F=Math.ceil(k/4);return[[2014,k%4],[2003,F]]}};let c=Ae("bulidings");var $=Mr(),N=d($),Z=u(d(N),2);let g;Z.__click=[Er,c];var h=u(Z,2);let I;h.__click=[Nr,c],o(N);var M=u(N,2);Ge(M,s,z=>{var k=Pe(),F=ie(k);ye(F,1,()=>Object.entries(n()),ke,(j,te)=>{var q=Pe();const A=y(()=>{const[L,Q]=e(te);return{recipeId:L,requiredBuildings:Q}});var ne=ie(q);{var pe=L=>{var Q=Cr();const W=y(()=>b.recipe[Number(e(A).recipeId)]),se=y(()=>i()[e(W).Type]/e(W).TimeSpend),le=y(()=>e(W).ResultCounts.reduce((ee,re)=>re+ee,0)),D=y(()=>e(A).requiredBuildings*e(se)*e(le)*60);var oe=d(Q),me=d(oe),Be=d(me);o(me);var be=u(me,2);const B=y(()=>{var ee,re;return(re=(ee=e(W))==null?void 0:ee.Results)==null?void 0:re[0]});Re(be,{get itemId(){return e(B)}}),o(oe);var X=u(oe,2),Y=d(X,!0);o(X);var ue=u(X,2);{var xe=ee=>{var re=Ar();const _e=y(()=>String(Math.round(e(A).requiredBuildings*10)/10)),Ie=y(()=>e(_e).indexOf(".")),Se=y(()=>e(Ie)===-1?1:0);var De=d(re),Xe=d(De);Ge(Xe,i,S=>{Re(S,{get itemId(){var V;return fe.factoryItems[(V=e(W))==null?void 0:V.Type][i()[e(W).Type]]}})}),o(De);var Me=u(De,2),P=d(Me,!0);o(Me),o(re),O(()=>{We(re,`padding-right: ${e(Se)+.5}em`),U(P,e(_e))}),f(ee,re)},qe=(ee,re)=>{{var _e=Ie=>{var Se=Pe(),De=ie(Se);ye(De,17,()=>_(e(D)),ke,(Xe,Me)=>{var P=Pe(),S=ie(P);{var V=R=>{var de=Or(),G=d(de),ge=d(G,!0);o(G);var K=u(G,2);Re(K,{get itemId(){return e(Me)[0]}}),o(de),O(()=>U(ge,e(Me)[1])),f(R,de)};C(S,R=>{e(Me)[1]>0&&R(V)})}f(Xe,P)}),f(Ie,Se)};C(ee,Ie=>{e(c)==="throughput"&&Ie(_e)},re)}};C(ue,ee=>{e(c)==="bulidings"?ee(xe):ee(qe,!1)})}o(Q),O(ee=>{var re;U(Be,`${ee??""}/s`),U(Y,((re=e(W))==null?void 0:re.Name)??"recipe"+e(A).recipeId)},[()=>Math.round(e(D)*100)/100]),f(L,Q)};C(ne,L=>{e(A).recipeId&&L(pe)})}f(j,q)}),f(z,k)}),o($),O((z,k)=>{g=Te(Z,1," px-4 py-2 rounded-l-lg  outline-gray-600",null,g,z),I=Te(h,1,"hover:bg-slate-500 px-4 py-2  rounded-r-lg  outline-gray-600",null,I,k)},[()=>({"bg-blue-700":e(c)==="bulidings","bg-gray-700":e(c)!=="bulidings","hover:bg-blue-500":e(c)==="bulidings","hover:bg-gray-500":e(c)!=="bulidings"}),()=>({"bg-blue-700":e(c)==="throughput","bg-gray-700":e(c)!=="throughput","hover:bg-blue-500":e(c)==="throughput","hover:bg-gray-500":e(c)!=="throughput"})]),f(v,$),Ce(),a()}Ke(["click"]);var Dr=x('<link rel="icon">'),Vr=(v,r)=>ce(r,!1),zr=(v,r)=>ce(r,!1),Fr=(v,r)=>r(),Lr=(v,r)=>ce(r,!1),Jr=x('<button class="fixed overscroll-contain w-screen h-screen backdrop-blur-2xl bg-black opacity-70 top-0 left-0 z-40" aria-label="close"></button> <dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2 fixed outline-1 rounded-2xl outline-slate-600"><h6 class="flex items-center justify-between"><span>Factory Globals</span><button class="bg-slate-800 hover:bg-slate-700 w-12 py-2">âœ–ï¸</button></h6> <!> <span class="flex-grow"></span> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to existing</button> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to future</button></dialog>',1),Ur=(v,r)=>e(r).setInterval(0),Gr=(v,r,t)=>e(r).setInterval(t),Kr=(v,r)=>e(r).setInterval(60),Hr=x("<button>Second</button>"),Xr=(v,r)=>ce(r,!0),Zr=x(`<!> <div class="flex gap-12 flex-wrap lg:flex-nowrap"><div class="lg:max-w-sm lg:block hidden max-h-screen  ml-auto overflow-y-auto"><!></div> <div class="max-w-2xl w-full lg:mx-0 mx-auto"><div class="flex  text-sm py-1"><span class="px-3 py-1 bg-slate-800 rounded-r-lg">Items per <span class="inline-flex"><button> </button> <button>Minute</button> <!></span></span> <span class="px-3 py-3 flex-grow text-right"></span> <button class="px-3 py-3 bg-slate-800 hover:bg-slate-700 rounded-l-lg">âš™ï¸
				Required Fabs to Process
				Items</button></div> <!></div> <!></div>`,1);function ca(v,r){Oe(r,!0);const[t,a]=He(),s=()=>T(m,"$defaultTier",t),n=()=>T(e(Z),"$header",t),i=()=>T(e(N),"$timeSpendChanged",t),l=()=>T(e(c),"$targetInterval",t),p=()=>T(e($),"$timeSpend",t);let{defaultTier:m}=fe,_=y(()=>new tt(r.data.recipeId,void 0,void 0,void 0,void 0,r.data.depth,r.data.targetAmount)),c=y(()=>e(_).targetInterval),$=y(()=>e(_).timeSpend),N=y(()=>e(_).timeSpendChanged),Z=y(()=>e(_).header);const g=60*60;let h=Ae(!1);const I=B=>{B||(B=e(_));const X=Le(B.recipe);if(X){const Y=X.Type,ue=s()[Y];B.tier.set(ue)}Le(B.children).forEach(Y=>I(Y)),ce(h,!1)};var M=Zr();Nt(B=>{var X=Dr();O(()=>{var Y,ue;Et.title=(Y=n())==null?void 0:Y[1],Ue(X,"href",(ue=n())==null?void 0:ue[0])}),f(B,X)});var z=ie(M);{var k=B=>{var X=Jr(),Y=ie(X);Y.__click=[Vr,h];var ue=u(Y,2),xe=d(ue),qe=u(d(xe));qe.__click=[zr,h],o(xe);var ee=u(xe,2);Sr(ee,{});var re=u(ee,4);re.__click=[Fr,I];var _e=u(re,2);_e.__click=[Lr,h],o(ue),f(B,X)};C(z,B=>{e(h)&&B(k)})}var F=u(z,2),j=d(F),te=d(j);Br(te,{}),o(j);var q=u(j,2),A=d(q),ne=d(A),pe=u(d(ne)),L=d(pe);let Q;L.__click=[Ur,_];var W=d(L);o(L);var se=u(L,2);let le;se.__click=[Gr,_,g];var D=u(se,2);{var oe=B=>{var X=Hr();let Y;X.__click=[Kr,_],O(ue=>Y=Te(X,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Y,ue),[()=>({active:l()===60})]),f(B,X)};C(D,B=>{p()!==60&&B(oe)})}o(pe),o(ne);var me=u(ne,4);me.__click=[Xr,h],o(A);var Be=u(A,2);Ge(Be,()=>e(_),B=>{pt(B,{get planner(){return e(_)}})}),o(q);var be=u(q,2);Ge(be,()=>e(_),B=>{jr(B,{get planner(){return e(_)}})}),o(F),O((B,X,Y)=>{Q=Te(L,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Q,B),U(W,`Cycle (${X??""}s)`),le=Te(se,1,"px-1.5 py-2 multi hover:bg-slate-700",null,le,Y)},[()=>({"animate-flash":i(),active:l()===p()}),()=>Math.round(p()/60*100)/100,()=>({active:l()===g})]),f(v,M),Ce(),a()}Ke(["click"]);export{ca as component,da as universal};
