var mt=Object.defineProperty;var _t=(u,a,e)=>a in u?mt(u,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):u[a]=e;var j=(u,a,e)=>_t(u,typeof a!="symbol"?a+"":a,e);import{c as xe,a as m,t as y}from"../chunks/e-TftYpV.js";import{at as ht,aG as gt,Q as bt,z as xt,A as je,B as It,K as yt,J as $t,L as kt,U as Bt,p as Pe,f as W,g as t,b as we,a as Te,s as h,c as d,r as o,h as fe,t as V,e as F,M as Ze}from"../chunks/DKDpRE7g.js";import{d as Ae,s as S}from"../chunks/CQBbwnrn.js";import{i as J}from"../chunks/PbJpwx8q.js";import{t as wt,s as qe,c as We,b as Pt,o as Je}from"../chunks/Cs5HLVpE.js";import{s as Se,a as k}from"../chunks/DSW42VuP.js";import{D as _,e as _e,i as he,I as Tt}from"../chunks/CRa7tc_X.js";import{w as ve,d as M,g as Be}from"../chunks/DRXOzK2u.js";import{r as Xe,b as He,L as Rt,s as qt}from"../chunks/BCod4-4X.js";import{p as Ge}from"../chunks/BlFFt1pI.js";import{i as St}from"../chunks/CaJYm0qw.js";function Ke(u,a,e){je&&It();var r=u,n=Bt,s,i=ht()?gt:bt;xt(()=>{i(n,n=a())&&(s&&yt(s),s=$t(()=>e(r)))}),je&&(r=kt)}function Ue(u,a,e,r){var n=u.__style;if(je||n!==a){var s=wt(a);(!je||s!==u.getAttribute("style"))&&(s==null?u.removeAttribute("style"):u.style.cssText=s),u.__style=a}return r}const Nt=!1,Et=({params:u,url:a})=>{const{id:e}=u,r=Number(e),n=a.searchParams.get("depth"),s=a.searchParams.get("targetAmount");return{recipeId:r,depth:n&&parseInt(n)||1,targetAmount:s&&parseInt(s)||1}},Jr=Object.freeze(Object.defineProperty({__proto__:null,load:Et,prerender:Nt},Symbol.toStringTag,{value:"Module"})),At=()=>{const u=localStorage==null?void 0:localStorage.getItem("defaultTiers");if(u){const a=JSON.parse(u);return ve(a)}},pe={defaultTier:At()??ve({Smelt:1,Assemble:.75,Research:1,Chemical:1,Refine:1,Particle:1,Fractionate:1,Proliferator:1}),availableTiers:{Smelt:[1,2],Assemble:[.75,1,1.5,3],Research:[1],Refine:[1],Chemical:[1,2],Particle:[1],Fractionate:[1],Proliferator:[.125,.2,.25]}};class Ot{constructor(a,e,r,n,s,i,l){this.recipeId=a,this.itemId=e,this.targetAmount=r,this.targetInterval=n,this.tier=s,this.proliferator=i,this.timeSpend=l}}const Ee=(u,a)=>{const e={...u};return Object.entries(a).forEach(([r,n])=>{const s=Number(r);e[s]=(e[s]??0)+n}),e};class De extends Ot{constructor(e,r,n,s,i=0,l=1,f){var P;const c=!!(r&&(_.canBeExtracted[r]||_.canBeMined[r]));!e&&!c&&(e=(P=_.alternativeRecipe[r])==null?void 0:P[0]);const g=ve(e),p=e?_.recipe[e]:void 0;let B=p==null?void 0:p.Results.findIndex(I=>r===I);const w=!r;!r&&(B??-1)>=0&&(r=p==null?void 0:p.Results[B??0]);const O=ve(r),v=ve((p==null?void 0:p.ResultCounts[B??0])??f??1),$=n?M([O,n],([I,N])=>N[I]):v,b=ve(p!=null&&p.Type?Be(pe.defaultTier)[p.Type]:1),R=ve(Be(pe.defaultTier).Proliferator),D=ve(0),x=M([g,b],([I,N])=>{var L;return((L=_.recipe[I])==null?void 0:L.TimeSpend)/N});s||(s=M([D,x],([I,N])=>I>0?I:N));super(g,O,$,s,b,R,x);j(this,"amountEditable");j(this,"manualAmount",ve());j(this,"manualInterval");j(this,"children",ve([]));j(this,"canBeMined",M(this.itemId,e=>_.canBeMined[e]));j(this,"canBeExtracted",M(this.itemId,e=>_.canBeExtracted[e]));j(this,"item",M(this.itemId,e=>_.item[e]));j(this,"recipe",M(this.recipeId,e=>_.recipe[e]));j(this,"options",M(this.itemId,e=>_.alternativeRecipe[e]));j(this,"timeSpendChanged",M(this.timeSpend,(e,r)=>{r(!!e);const n=setTimeout(()=>r(!e),1400);return()=>clearTimeout(n)}));j(this,"relativeSpeed",M([this.targetInterval,this.timeSpend],([e,r])=>e/r));j(this,"requiredBuildings",M([this.targetAmount,this.recipe,this.itemId,this.relativeSpeed,this.proliferator],([e,r,n,s,i])=>{const l=r==null?void 0:r.Results.findIndex(c=>n===c),f=e/(r==null?void 0:r.ResultCounts[l])/s;return isNaN(f)?e:f}));j(this,"providedItemsPerInterval",M([this.recipe,this.relativeSpeed,this.requiredBuildings,this.itemId,this.targetAmount],([e,r,n,s,i])=>{if(!e&&s&&(_.canBeMined[s]||_.canBeExtracted[s]))return{[s]:i};const l={};return e==null||e.Results.forEach((f,c)=>{l[f]=e.ResultCounts[c]*r*n}),l}));j(this,"childrenProvideItemsPerInterval",M(this.children,(e,r)=>{const n=new Array(e.length),s=e.map((l,f)=>l.providedItemsPerInterval.subscribe(c=>{n[f]=c;const g=n.filter(p=>!!p).reduce((p,B)=>Ee(p,B),{});r(g)})),i=n.filter(l=>!!l).reduce((l,f)=>Ee(l,f),{});return r(i),()=>s.forEach(l=>l())}));j(this,"requiredBuildingsByRecipeId",M([this.children,this.recipeId,this.requiredBuildings],([e,r,n],s)=>{const i=new Array(e.length),l=e.map((c,g)=>c.requiredBuildingsByRecipeId.subscribe(p=>{i[g]=p;const B=i.filter(w=>!!w).reduce((w,O)=>Ee(w,O),{});if(r){const w=r;B[w]=(B[w]??0)+n}s(B)})),f=i.filter(c=>!!c).reduce((c,g)=>Ee(c,g),{});if(r){const c=r;f[c]=(f[c]??0)+n}return s(f),()=>l.forEach(c=>c())}));j(this,"fabsByType",M(this.requiredBuildingsByRecipeId,e=>Object.entries(e).reduce((r,[n,s])=>{const i=Number(n),l=_.recipe[i].Type;return r[l]=(r[l]??0)+s,r},{})));j(this,"childrenByItemId",M(this.children,(e,r)=>{const n=new Array(e.length),s=e.map((l,f)=>l.itemId.subscribe(c=>{n[f]=[c,l];const g=n.filter(p=>!!p).reduce((p,[B,w])=>(p[B]=w,p),{});r(g)})),i=n.filter(l=>!!l).reduce((l,[f,c])=>(l[f]=c,l),{});return r(i),()=>s.forEach(l=>l())}));j(this,"requiredItemsPerInterval",M([this.recipe,this.relativeSpeed,this.requiredBuildings],([e,r,n])=>{const s={};return e==null||e.Items.forEach((i,l)=>s[i]=e.ItemCounts[l]*r*n),s}));j(this,"inputsOutputs",M([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval],([e,r,n])=>{const s=new Set;return Object.keys(r).forEach(i=>{s.add(Number(i))}),Object.keys(e??{}).forEach(i=>{s.add(Number(i))}),Object.keys(n).forEach(i=>{s.add(Number(i))}),s}));j(this,"surplus",M([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval,this.providedItemsPerInterval,this.itemId],([e,r,n,s])=>{const i=Ee(e,n);return Object.entries(r).forEach(([l,f])=>i[Number(l)]=(i[Number(l)]??0)-f),Object.entries(i).filter(([,l])=>l<=0).forEach(([l])=>delete i[Number(l)]),i}));j(this,"deficit",M([this.childrenProvideItemsPerInterval,this.requiredItemsPerInterval],([e,r])=>{const n={...e};return Object.entries(r).forEach(([s,i])=>n[Number(s)]=(n[Number(s)]??0)-i),Object.entries(n).filter(([,s])=>s>=0).forEach(([s])=>delete n[Number(s)]),Object.keys(n).forEach(s=>{var l;const i=Number(s);(l=_.producedVia[i])!=null&&l.length||delete n[i]}),n}));j(this,"totals",M([this.itemId,this.requiredBuildings,this.children],([e,r,n])=>{const s={};return s[e]=r,n.map(i=>i.totals).forEach(i=>{Object.entries(i).forEach(([l,f])=>{const c=Number(l);s[c]=(s[c]??0)+f})}),s}));this.depth=i,this.amountEditable=w,this.manualAmount=v,this.manualInterval=D,l>i&&this.children.set(this.dbd(l))}setAmount(e){this.manualAmount.set(e)}setRecipeId(e){this.recipeId.set(e),this.expand()}deleteChild(e){this.children.update(r=>{const n=r.findIndex(s=>Be(s.itemId)===e);return r.splice(n,1),r})}setInterval(e){this.manualInterval.set(e)}expand(){this.children.set(this.dbd())}planFor(e){this.children.update(r=>(r.push(new De(void 0,e,this.requiredItemsPerInterval,this.targetInterval,this.depth+1)),r))}dbd(e){const r=[],n=Be(this.recipe);return n==null||n.Items.forEach((s,i)=>{var c;if(!((c=_.alternativeRecipe[s])!=null&&c.length))return;const l=new De(void 0,s,this.requiredItemsPerInterval,this.targetInterval,this.depth+1,e);r.push(l);const f=Be(l.providedItemsPerInterval);Object.entries(f).forEach(([g,p])=>{})}),r}}var Ct=(u,a,e)=>a(t(e)),jt=y("<button> </button>"),Dt=y('<div><span class="text-xs text-gray-400">Tier</span> <!></div>'),Mt=(u,a)=>fe(a,!0),Vt=y('<button class="text-center min-w-16 h-10 rounded-l-lg bg-slate-800 hover:bg-slate-700 py-2 px-3 flex justify-around items-end gap-2 relative "><span class="text-xs text-gray-400 absolute top-0"> </span> <b class="bottom-0.5 absolute"> </b></button>');function Ft(u,a){Pe(a,!0);const[e,r]=Se(),n=()=>k(l,"$recipe",e),s=()=>k(f,"$tier",e),i=()=>k(c,"$requiredBuildings",e);let{recipe:l,tier:f,requiredBuildings:c}=a.planner,g=we(!1);const p=$=>{a.planner.tier.set($),fe(g,!1)};var B=xe(),w=W(B);{var O=$=>{var b=Dt(),R=h(d(b),2);_e(R,1,()=>pe.availableTiers[n().Type],he,(D,x)=>{var P=jt();let I;P.__click=[Ct,p,x];var N=d(P,!0);o(P),V(L=>{I=qe(P,1,"px-2 py-1 outline-slate-600 hover:bg-slate-700 text-sm  rounded",null,I,L),S(N,t(x))},[()=>({"outline-1":t(x)===s(),active:t(x)===s()})]),m(D,P)}),o(b),m($,b)},v=$=>{var b=Vt();b.__click=[Mt,g];var R=d(b),D=d(R);o(R);var x=h(R,2),P=d(x,!0);o(x),o(b),V(I=>{S(D,`tier ${s()??""}`),S(P,I)},[()=>Math.round(i()*100)/100]),m($,b)};J(w,$=>{t(g)?$(O):$(v,!1)})}m(u,B),Te(),r()}Ae(["click"]);var zt=y('<div class="flex gap-4"><span> </span> <span class="text-right flex-grow"> </span></div>'),Lt=y('<div class="flex odd:bg-gray-950 gap-2 px-2 items-center"><span class="w-14 text-right"> </span> <span class="text-slate-300 text-xs">x</span> <span> </span> <span class="text-slate-400 text-xs"> </span> <em class="text-right flex-grow"> </em></div>'),Jt=y('<div><h3 class="bg-blue-800 py-2 px-4  text-center "><span class="w-14 text-right"> </span> <span class="text-xs text-slate-400">x</span> </h3> <div class="mb-4 my-4 mx-auto  grid grid-cols-2 gap-x-8 justify-center"></div> <!></div>');function Ut(u,a){Pe(a,!0);const[e,r]=Se(),n=()=>k(g,"$fabsByType",e),s=()=>k(B,"$requiredBuildings",e),i=()=>k(p,"$recipe",e),l=()=>k(c,"$requiredBuildingsByRecipeId",e),f=()=>k(w,"$defaultTier",e);let{requiredBuildingsByRecipeId:c,fabsByType:g,recipe:p,requiredBuildings:B}=a.planner,{defaultTier:w}=pe,O=F(()=>Object.entries(n()));var v=Jt(),$=d(v),b=d($),R=d(b,!0);o(b);var D=h(b,3);o($);var x=h($,2);_e(x,21,()=>t(O),he,(I,N)=>{var L=zt();const G=F(()=>{const[ee,X]=t(N);return{fabType:ee,requiredFabs:X}});var T=d(L),z=d(T,!0);o(T);var oe=h(T,2),Y=d(oe,!0);o(oe),o(L),V(()=>{S(z,t(G).fabType),S(Y,t(G).requiredFabs)}),m(I,L)}),o(x);var P=h(x,2);_e(P,1,()=>Object.entries(l()),he,(I,N,L,G)=>{var T=xe();const z=F(()=>{const[ee,X]=t(N);return{recipeId:ee,requiredBuildings:X}});var oe=W(T);{var Y=ee=>{var X=Lt();const de=F(()=>_.recipe[Number(t(z).recipeId)]),te=F(()=>f()[t(de).Type]/t(de).TimeSpend),ce=F(()=>t(de).ResultCounts.reduce((ge,Ce)=>Ce+ge,0)),Ie=F(()=>t(z).requiredBuildings*t(te)*t(ce)*60);var E=d(X),K=d(E,!0);o(E);var Q=h(E,4),se=d(Q,!0);o(Q);var ue=h(Q,2),Me=d(ue);o(ue);var Oe=h(ue,2),Ve=d(Oe);o(Oe),o(X),V(()=>{var ge;S(K,t(z).requiredBuildings),S(se,((ge=t(de))==null?void 0:ge.Name)??"recipe"+t(z).recipeId),S(Me,`tier ${f()[t(de).Type]??""}`),S(Ve,`${t(Ie)??""}/s`)}),m(ee,X)};J(oe,ee=>{t(z).recipeId&&ee(Y)})}m(I,T)}),o(v),V(()=>{S(R,s()),S(D,` ${i().Name??""}`)}),m(u,v),Te(),r()}var Gt=(u,a)=>fe(a,!1),Kt=y('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2"><!> <button class="bg-green-800 py-2 rounded-xl mt-auto">close</button></dialog>'),Qt=(u,a)=>a.deletecb(),Zt=y(`<style scoped="">input::-webkit-outer-spin-button,
          input::-webkit-inner-spin-button {
              /* display: none; <- Crashes Chrome on hover */
              -webkit-appearance: none;
              margin: 0; /* <-- Apparently some margin are still there even though it's hidden */
          }

          input[type=number] {
              -moz-appearance: textfield;
          }</style> <input type="number" class="text-left rounded-r-lg w-16">`,1),Ht=y('<div class="flex items-center"><span class="pl-2">ğŸ—‘ï¸</span>ï¸ <span class="text-sm py-2 block pr-4"> </span></div>'),Wt=y("<option>extraction/mining</option>"),Xt=y("<option> </option>"),Yt=y(" <select><!><!></select>",1),er=(u,a)=>fe(a,!0),tr=y('<button class="py-1 rounded-xl px-4 bg-slate-800">ğŸš§</button>'),rr=y('<span class="flex-grow"> </span> <!>',1),ar=(u,a,e,r)=>{var n;return t(a)<0&&((n=_.producedVia[t(e)])==null?void 0:n.length)>0&&r.planner.planFor(t(e))},sr=y('<div class="flex items-center"><span class="pl-2">ğŸ“</span>ï¸ <span class="text-sm py-2 block pr-4"> </span></div>'),nr=y('<div class="flex items-center"><span class="px-3.5"></span>ï¸ <span class="text-sm py-2 block pr-4"> </span></div>'),ir=y("<div><!></div>"),lr=y('<div class="flex gap-2"><button><!></button> <!></div>'),or=y('<div class="flex flex-col gap-0.5"></div>'),dr=y('<!> <div class="flex gap-1 max-w-2xl items-center"><button class="bg-slate-800 hover:bg-slate-700  text-center rounded-r-lg  "><!></button> <div class="flex-grow px-4"><h5 class="flex"><!></h5></div> <!></div> <!>',1);function Ye(u,a){Pe(a,!0);const[e,r]=Se(),n=()=>k(G,"$targetAmount",e),s=()=>k(x,"$recipeId",e),i=()=>k(R,"$itemId",e),l=()=>k(X,"$options",e),f=()=>k(b,"$item",e),c=()=>k(D,"$recipe",e),g=()=>k(N,"$children",e),p=()=>k(I,"$requiredBuildings",e),B=()=>k(Y,"$inputsOutputs",e),w=()=>k(z,"$providedItemsPerInterval",e),O=()=>k(T,"$childrenProvideItemsPerInterval",e),v=()=>k(oe,"$requiredItemsPerInterval",e),$=()=>k(L,"$childrenByItemId",e);let{item:b,itemId:R,recipe:D,recipeId:x,targetInterval:P,requiredBuildings:I,children:N,childrenByItemId:L,targetAmount:G,childrenProvideItemsPerInterval:T,providedItemsPerInterval:z,requiredItemsPerInterval:oe,inputsOutputs:Y,deficit:ee,options:X,tier:de}=a.planner,te=we(Ge(n())),ce=we(Ge(s())),Ie=we(!1);Ze(()=>{a.planner.amountEditable&&n()!==t(te)&&a.planner.setAmount(t(te))}),Ze(()=>{t(ce)!==s()&&a.planner.setRecipeId(t(ce))});var E=dr(),K=W(E);{var Q=q=>{var C=Kt(),U=d(C);Ut(U,{get planner(){return a.planner}});var A=h(U,2);A.__click=[Gt,Ie],o(C),m(q,C)};J(K,q=>{t(Ie)&&q(Q)})}var se=h(K,2),ue=d(se);ue.__click=[Qt,a];var Me=d(ue);{var Oe=q=>{var C=Zt(),U=h(W(C),2);Xe(U),We(U,()=>t(te),A=>fe(te,A)),m(q,C)},Ve=q=>{var C=Ht(),U=h(d(C),2),A=d(U,!0);o(U),o(C),V(me=>{Ue(U,`padding-left: ${a.planner.depth*1.1}rem`),S(A,me)},[()=>Math.round(n()*100)/100]),m(q,C)};J(Me,q=>{a.planner.amountEditable?q(Oe):q(Ve,!1)})}o(ue);var ge=h(ue,2),Ce=d(ge),et=d(Ce);{var tt=q=>{var C=Yt(),U=W(C),A=h(U),me=d(A);{var re=ne=>{var Z=Wt();Z.value=(Z.__value=void 0)==null?"":void 0,V(()=>He(Z,s()===void 0)),m(ne,Z)};J(me,ne=>{(_.canBeExtracted[i()]||_.canBeMined[i()])&&ne(re)})}var le=h(me);_e(le,1,l,he,(ne,Z)=>{var ie=Xt(),ye={},Fe=d(ie,!0);o(ie),V(()=>{ye!==(ye=_.recipe[t(Z)].ID)&&(ie.value=(ie.__value=_.recipe[t(Z)].ID)==null?"":_.recipe[t(Z)].ID),He(ie,x===_.recipe[t(Z)].ID),S(Fe,_.recipe[t(Z)].Name)}),m(ne,ie)}),o(A),V(()=>S(U,`${f().Name??""}: `)),Pt(A,()=>t(ce),ne=>fe(ce,ne)),m(q,C)},rt=q=>{var C=rr(),U=W(C),A=d(U,!0);o(U);var me=h(U,2);{var re=le=>{var ne=tr();ne.__click=[er,Ie],m(le,ne)};J(me,le=>{g().length>1&&!a.planner.amountEditable&&le(re)})}V(()=>{var le;return S(A,(le=c())==null?void 0:le.Name)}),m(q,C)};J(et,q=>{i()&&(l().length>1||l().length>=1&&_.canBeExtracted[i()]||_.canBeMined[i()])?q(tt):q(rt,!1)})}o(Ce),o(ge);var at=h(ge,2);{var st=q=>{Ft(q,{get planner(){return a.planner}})};J(at,q=>{p()&&s()&&q(st)})}o(se);var nt=h(se,2);{var it=q=>{var C=or();_e(C,5,B,he,(U,A)=>{var me=xe();const re=F(()=>{var Z,ie,ye;return(((Z=w())==null?void 0:Z[t(A)])??0)+(((ie=O())==null?void 0:ie[t(A)])??0)-(((ye=v())==null?void 0:ye[t(A)])??0)}),le=F(()=>$()[t(A)]);var ne=W(me);Ke(ne,()=>t(A),Z=>{var ie=xe(),ye=W(ie);{var Fe=Re=>{Ye(Re,{get planner(){return t(le)},deletecb:()=>a.planner.deleteChild(t(A))})},lt=Re=>{var ze=lr(),Ne=d(ze);let Qe;Ne.__click=[ar,re,A,a];var ot=d(Ne);{var dt=H=>{var ae=sr(),be=h(d(ae),2),$e=d(be,!0);o(be),o(ae),V(ke=>{Ue(be,`padding-left: ${(a.planner.depth+.5)*1.1}rem`),S($e,ke)},[()=>Math.round(t(re)*100)/100]),m(H,ae)},ct=(H,ae)=>{{var be=$e=>{var ke=nr(),Le=h(d(ke),2),pt=d(Le,!0);o(Le),o(ke),V(ft=>{Ue(Le,`padding-left: ${(a.planner.depth+.5)*1.1}rem`),S(pt,ft)},[()=>Math.round(t(re)*100)/100]),m($e,ke)};J(H,$e=>{t(A)!==i()&&t(re)!==0&&$e(be)},ae)}};J(ot,H=>{var ae;t(re)<0&&((ae=_.producedVia[t(A)])==null?void 0:ae.length)>0?H(dt):H(ct,!1)})}o(Ne);var ut=h(Ne,2);{var vt=H=>{var ae=ir();let be;var $e=d(ae);Tt($e,{get itemId(){return t(A)}}),o(ae),V(ke=>be=qe(ae,1,"flex gap-2 items-center",null,be,ke),[()=>({"text-green-500":t(re)>0,"text-red-500":t(re)<0})]),m(H,ae)};J(ut,H=>{t(A)!==i()&&t(re)!==0&&H(vt)})}o(ze),V(H=>Qe=qe(Ne,1,"bg-slate-800 text-center rounded-r-lg",null,Qe,H),[()=>{var H;return{"hover:bg-slate-700":t(re)<0&&((H=_.producedVia[t(A)])==null?void 0:H.length)>0}}]),m(Re,ze)};J(ye,Re=>{t(le)?Re(Fe):Re(lt,!1)})}m(Z,ie)}),m(U,me)}),o(C),m(q,C)};J(nt,q=>{var C;((C=B())==null?void 0:C.size)>0&&q(it)})}m(u,E),Te(),r()}Ae(["click"]);var cr=y('<div class="flex flex-col items-stretch group w-full "><div class="my-2 z-30"><a class="w-xs"> </a></div></div>'),ur=y('<div class="flex gap-0.5 flex-col mb-4 sticky top-0 mr-2 backdrop-blur-3xl backdrop-opacity-75  z-50"><!> <label for="recipeName">ingredient or recipe name</label><input id="recipeName"></div> <!>',1);function vr(u,a){Pe(a,!0);let e=we(Ge([])),r=Je(),n=Je(),s=Je(),i=we(""),l=F(()=>t(i)?_.items.filter(v=>v.Name.toLowerCase().includes(t(i).toLowerCase())).map(v=>v.ID):[]),f=F(()=>(()=>{const v=new Set;return t(l).forEach($=>{for(const b of _.relatedRecipes[$]??[])v.add(b)}),v})()),c=F(()=>_.recipees.filter(v=>t(e).length>0?t(e).includes(v.Type):!0).filter(v=>t(i)?t(f).has(v.ID):!0).filter(v=>r.checked===null?!0:r.checked?_.buildableRecipees.has(v.ID):!_.buildableRecipees.has(v.ID)).filter(v=>n.checked===null?!0:n.checked?_.fluidRecipees.has(v.ID):!_.fluidRecipees.has(v.ID)).filter(v=>s.checked===null?!0:s.checked?_.entityRecipees.has(v.ID):!_.entityRecipees.has(v.ID)));new Set(_.recipees.map(v=>v.Type));var g=ur(),p=W(g),B=d(p);J(B,v=>{});var w=h(B,3);Xe(w),o(p);var O=h(p,2);_e(O,17,()=>t(c),he,(v,$)=>{var b=cr(),R=d(b),D=d(R),x=d(D,!0);o(D),o(R),o(b),V(P=>{qt(D,"href",P),S(x,t($).Name)},[()=>Rt.recipe(t($).ID)]),m(v,b)}),We(w,()=>t(i),v=>fe(i,v)),m(u,g),Te()}Ae(["click"]);var pr=(u,a,e,r)=>a(t(e),t(r)),fr=y('<button class="flex-grow shadow-xl py-2 m-4 outline-amber-100 outline-1 active bg-slate-500 hover:bg-slate-400  text-white rounded-lg"> </button>'),mr=(u,a,e,r)=>a(t(e),t(r)),_r=y('<button class="flex-grow shadow-xl py-2 m-4	bg-slate-800 hover:bg-slate-700 text-gray-300 rounded-lg"> </button>'),hr=y('<div><h4 class="bg-blue-900 py-2 px-4 rounded-t"> </h4> <div class="flex bg-gray-600 "></div></div>'),gr=y('<h3 class="bg-blue-800  rounded-t py-5 px-4">default tier for new factories</h3> <!>',1);function br(u,a){Pe(a,!1);const[e,r]=Se(),n=()=>k(s,"$defaultTierReadable",e);let s=pe.defaultTier;n();const i=(c,g)=>{const p={...n(),[c]:g};localStorage.setItem("defaultTiers",JSON.stringify(p)),pe.defaultTier.set(p)};St();var l=gr(),f=h(W(l),2);_e(f,1,()=>Object.keys(n()),he,(c,g)=>{var p=xe(),B=W(p);{var w=O=>{var v=hr(),$=d(v),b=d($,!0);o($);var R=h($,2);_e(R,5,()=>pe.availableTiers[t(g)],he,(D,x)=>{var P=xe(),I=W(P);{var N=G=>{var T=fr();T.__click=[pr,i,g,x];var z=d(T,!0);o(T),V(()=>S(z,t(x))),m(G,T)},L=G=>{var T=_r();T.__click=[mr,i,g,x];var z=d(T,!0);o(T),V(()=>S(z,t(x))),m(G,T)};J(I,G=>{t(x)===n()[t(g)]?G(N):G(L,!1)})}m(D,P)}),o(R),o(v),V(()=>S(b,t(g))),m(O,v)};J(B,O=>{var v;((v=pe.availableTiers[t(g)])==null?void 0:v.length)>1&&O(w)})}m(c,p)}),m(u,l),Te(),r()}Ae(["click"]);var xr=y('<div class="flex odd:bg-gray-950 gap-2 px-2"><span class="flex-grow"> </span> <span> </span> <em> </em></div>'),Ir=y('<div class="max-w-sm flex flex-col mr-auto gap-0.5"><h4 class="px-4 py-2 bg-slate-800 rounded-t-lg">all required buildings</h4> <!></div>');function yr(u,a){Pe(a,!0);const[e,r]=Se(),n=()=>k(f,"$itemId",e),s=()=>k(l,"$requiredBuildingsByRecipeId",e),i=()=>k(c,"$defaultTier",e);let{requiredBuildingsByRecipeId:l,itemId:f}=a.planner,{defaultTier:c}=pe;var g=Ir(),p=h(d(g),2);Ke(p,n,B=>{var w=xe(),O=W(w);_e(O,1,()=>Object.entries(s()),he,(v,$)=>{var b=xe();const R=F(()=>{const[P,I]=t($);return{recipeId:P,requiredBuildings:I}});var D=W(b);{var x=P=>{var I=xr();const N=F(()=>_.recipe[Number(t(R).recipeId)]),L=F(()=>i()[t(N).Type]/t(N).TimeSpend),G=F(()=>t(N).ResultCounts.reduce((te,ce)=>ce+te,0)),T=F(()=>t(R).requiredBuildings*t(L)*t(G)*60);var z=d(I),oe=d(z,!0);o(z);var Y=h(z,2),ee=d(Y,!0);o(Y);var X=h(Y,2),de=d(X);o(X),o(I),V(()=>{var te;S(oe,((te=t(N))==null?void 0:te.Name)??"recipe"+t(R).recipeId),S(ee,t(R).requiredBuildings),S(de,`${t(T)??""}/s`)}),m(P,I)};J(D,P=>{t(R).recipeId&&P(x)})}m(v,b)}),m(B,w)}),o(g),m(u,g),Te(),r()}var $r=(u,a)=>a(),kr=(u,a)=>fe(a,!1),Br=y('<dialog open class="max-w-2xl w-full h-full max-h-10/12 mx-auto top-1/12 bg-gray-950 z-50 md:px-5 text-amber-50 flex flex-col py-4 gap-2"><!> <span class="flex-grow"></span> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to existing</button> <button class="bg-green-800 hover:bg-green-700 w-full py-1">apply to future</button></dialog>'),wr=(u,a)=>t(a).setInterval(0),Pr=(u,a,e)=>t(a).setInterval(e),Tr=(u,a)=>t(a).setInterval(60),Rr=y("<button>Second</button>"),qr=(u,a)=>fe(a,!0),Sr=y(`<!> <div class="flex gap-12"><div class="max-w-sm lg:block hidden max-h-screen  ml-auto overflow-y-auto"><!></div> <div class="max-w-2xl w-full lg:mx-0 mx-auto"><div class="flex  text-sm py-1"><span class="px-3 py-1 bg-slate-800 rounded-r-lg">Items per <span class="inline-flex"><button> </button> <button>Minute</button> <!></span></span> <span class="px-3 py-3 flex-grow text-right"></span> <button class="px-3 py-3 bg-slate-800 hover:bg-slate-700 rounded-l-lg">âš™ï¸
				Required Fabs to Process
				Items</button></div> <!></div> <!></div>`,1);function Ur(u,a){Pe(a,!0);const[e,r]=Se(),n=()=>k(f,"$defaultTier",e),s=()=>k(t(B),"$timeSpendChanged",e),i=()=>k(t(g),"$targetInterval",e),l=()=>k(t(p),"$timeSpend",e);let{defaultTier:f}=pe,c=F(()=>new De(a.data.recipeId,void 0,void 0,void 0,void 0,a.data.depth,a.data.targetAmount)),g=F(()=>t(c).targetInterval),p=F(()=>t(c).timeSpend),B=F(()=>t(c).timeSpendChanged);const w=60*60;let O=we(!1);const v=E=>{E||(E=t(c));const K=Be(E.recipe);if(K){const Q=K.Type,se=n()[Q];E.tier.set(se)}Be(E.children).forEach(Q=>v(Q)),fe(O,!1)};var $=Sr(),b=W($);{var R=E=>{var K=Br(),Q=d(K);br(Q,{});var se=h(Q,4);se.__click=[$r,v];var ue=h(se,2);ue.__click=[kr,O],o(K),m(E,K)};J(b,E=>{t(O)&&E(R)})}var D=h(b,2),x=d(D),P=d(x);vr(P,{}),o(x);var I=h(x,2),N=d(I),L=d(N),G=h(d(L)),T=d(G);let z;T.__click=[wr,c];var oe=d(T);o(T);var Y=h(T,2);let ee;Y.__click=[Pr,c,w];var X=h(Y,2);{var de=E=>{var K=Rr();let Q;K.__click=[Tr,c],V(se=>Q=qe(K,1,"px-1.5 py-2 multi hover:bg-slate-700",null,Q,se),[()=>({active:i()===60})]),m(E,K)};J(X,E=>{l()!==60&&E(de)})}o(G),o(L);var te=h(L,4);te.__click=[qr,O],o(N);var ce=h(N,2);Ke(ce,()=>t(c),E=>{Ye(E,{get planner(){return t(c)}})}),o(I);var Ie=h(I,2);yr(Ie,{get planner(){return t(c)}}),o(D),V((E,K,Q)=>{z=qe(T,1,"px-1.5 py-2 multi hover:bg-slate-700",null,z,E),S(oe,`Cycle (${K??""}s)`),ee=qe(Y,1,"px-1.5 py-2 multi hover:bg-slate-700",null,ee,Q)},[()=>({"animate-flash":s(),active:i()===l()}),()=>Math.round(l()/60*100)/100,()=>({active:i()===w})]),m(u,$),Te(),r()}Ae(["click"]);export{Ur as component,Jr as universal};
